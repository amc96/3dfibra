2026-01-09T13:01:44.000000000Z [inf]  Starting Container
2026-01-09T13:01:45.880715252Z [err]  "use strict";var z=Object.create;var I=Object.defineProperty;var Q=Object.getOwnPropertyDescriptor;var k=Object.getOwnPropertyNames;var J=Object.getPrototypeOf,Y=Object.prototype.hasOwnProperty;var G=(e,n)=>{for(var t in n)I(e,t,{get:n[t],enumerable:!0})},D=(e,n,t,i)=>{if(n&&typeof n=="object"||typeof n=="function")for(let r of k(n))!Y.call(e,r)&&r!==t&&I(e,r,{get:()=>n[r],enumerable:!(i=Q(n,r))||i.enumerable});return e};var S=(e,n,t)=>(t=e!=null?z(J(e)):{},D(n||!e||!e.__esModule?I(t,"default",{value:e,enumerable:!0}):t,e)),K=e=>D(I({},"__esModule",{value:!0}),e);var ue={};G(ue,{log:()=>P});module.exports=K(ue);var y=S(require("express"),1);var F=require("drizzle-orm/node-postgres"),X=require("drizzle-orm/node-postgres/migrator"),R=S(require("pg"),1);var T={};G(T,{insertPlanSchema:()=>oe,plans:()=>f});var g=require("drizzle-orm/pg-core");var c=require("drizzle-orm"),u=require("zod"),o={INT8_MIN:-128,INT8_MAX:127,INT8_UNSIGNED_MAX:255,INT16_MIN:-32768,INT16_MAX:32767,INT16_UNSIGNED_MAX:65535,INT24_MIN:-8388608,INT24_MAX:8388607,INT24_UNSIGNED_MAX:16777215,INT32_MIN:-2147483648,INT32_MAX:2147483647,INT32_UNSIGNED_MAX:4294967295,INT48_MIN:-0x800000000000,INT48_MAX:0x7fffffffffff,INT48_UNSIGNED_MAX:0xffffffffffff,INT64_MIN:-9223372036854775808n,INT64_MAX:9223372036854775807n,INT64_UNSIGNED_MAX:18446744073709551615n};function l(e,n){return n.includes(e.columnType)}function Z(e){return"enumValues"in e&&Array.isArray(e.enumValues)&&e.enumValues.length>0}var ee=u.z.union([u.z.string(),u.z.number(),u.z.boolean(),u.z.null()]),te=u.z.union([ee,u.z.record(u.z.any()),u.z.array(u.z.any())]),re=u.z.custom(e=>e instanceof Buffer);function v(e,n){let t=n?.zodInstance??u.z,i=n?.coerce??{},r;return Z(e)&&(r=e.enumValues.length?t.enum(e.enumValues):t.string()),r||(l(e,["PgGeometry","PgPointTuple"])?r=t.tuple([t.number(),t.number()]):l(e,["PgGeometryObject","PgPointObject"])?r=t.object({x:t.number(),y:t.number()}):l(e,["PgHalfVector","PgVector"])?(r=t.array(t.number()),r=e.dimensions?r.length(e.dimensions):r):l(e,["PgLine"])?r=t.tuple([t.number(),t.number(),t.number()]):l(e,["PgLineABC"])?r=t.object({a:t.number(),b:t.number(),c:t.number()}):l(e,["PgArray"])?(r=t.array(v(e.baseColumn,t)),r=e.size?r.length(e.size):r):e.dataType==="array"?r=t.array(t.any()):e.dataType==="number"?r=ne(e,t,i):e.dataType==="bigint"?r=ie(e,t,i):e.dataType==="boolean"?r=i===!0||i.boolean?t.coerce.boolean():t.boolean():e.dataType==="date"?r=i===!0||i.date?t.coerce.date():t.date():e.dataType==="string"?r=se(e,t,i):e.dataType==="json"?r=te:e.dataType==="custom"?r=t.any():e.dataType==="buffer"&&(r=re)),r||(r=t.any()),r}function ne(e,n,t){let i=e.getSQLType().includes("unsigned"),r,s,a=!1;l(e,["MySqlTinyInt","SingleStoreTinyInt"])?(r=i?0:o.INT8_MIN,s=i?o.INT8_UNSIGNED_MAX:o.INT8_MAX,a=!0):l(e,["PgSmallInt","PgSmallSerial","MySqlSmallInt","SingleStoreSmallInt"])?(r=i?0:o.INT16_MIN,s=i?o.INT16_UNSIGNED_MAX:o.INT16_MAX,a=!0):l(e,["PgReal","MySqlFloat","MySqlMediumInt","SingleStoreMediumInt","SingleStoreFloat"])?(r=i?0:o.INT24_MIN,s=i?o.INT24_UNSIGNED_MAX:o.INT24_MAX,a=l(e,["MySqlMediumInt","SingleStoreMediumInt"])):l(e,["PgInteger","PgSerial","MySqlInt","SingleStoreInt"])?(r=i?0:o.INT32_MIN,s=i?o.INT32_UNSIGNED_MAX:o.INT32_MAX,a=!0):l(e,["PgDoublePrecision","MySqlReal","MySqlDouble","SingleStoreReal","SingleStoreDouble","SQLiteReal"])?(r=i?0:o.INT48_MIN,s=i?o.INT48_UNSIGNED_MAX:o.INT48_MAX):l(e,["PgBigInt53","PgBigSerial53","MySqlBigInt53","MySqlSerial","SingleStoreBigInt53","SingleStoreSerial","SQLiteInteger"])?(i=i||l(e,["MySqlSerial","SingleStoreSerial"]),r=i?0:Number.MIN_SAFE_INTEGER,s=Number.MAX_SAFE_INTEGER,a=!0):l(e,["MySqlYear","SingleStoreYear"])?(r=1901,s=2155,a=!0):(r=Number.MIN_SAFE_INTEGER,s=Number.MAX_SAFE_INTEGER);let p=t===!0||t?.number?n.coerce.number():n.number();return p=p.min(r).max(s),a?p.int():p}function ie(e,n,t){let i=e.getSQLType().includes("unsigned"),r=i?0n:o.INT64_MIN,s=i?o.INT64_UNSIGNED_MAX:o.INT64_MAX;return(t===!0||t?.bigint?n.coerce.bigint():n.bigint()).min(r).max(s)}function se(e,n,t){if(l(e,["PgUUID"]))return n.string().uuid();let i,r,s=!1;l(e,["PgVarchar","SQLiteText"])?i=e.length:l(e,["MySqlVarChar","SingleStoreVarChar"])?i=e.length??o.INT16_UNSIGNED_MAX:l(e,["MySqlText","SingleStoreText"])&&(e.textType==="longtext"?i=o.INT32_UNSIGNED_MAX:e.textType==="mediumtext"?i=o.INT24_UNSIGNED_MAX:e.textType==="text"?i=o.INT16_UNSIGNED_MAX:i=o.INT8_UNSIGNED_MAX),l(e,["PgChar","MySqlChar","SingleStoreChar"])&&(i=e.length,s=!0),l(e,["PgBinaryVector"])&&(r=/^[01]+$/,i=e.dimensions);let a=t===!0||t?.string?n.coerce.string():n.string();return a=r?a.regex(r):a,i&&s?a.length(i):i?a.max(i):a}function C(e){return(0,c.isTable)(e)?(0,c.getTableColumns)(e):(0,c.getViewSelectedFields)(e)}function w(e,n,t,i){let r={};for(let[s,a]of Object.entries(e)){if(!(0,c.is)(a,c.Column)&&!(0,c.is)(a,c.SQL)&&!(0,c.is)(a,c.SQL.Aliased)&&typeof a=="object"){let W=(0,c.isTable)(a)||(0,c.isView)(a)?C(a):a;r[s]=w(W,n[s]??{},t,i);continue}let p=n[s];if(p!==void 0&&typeof p!="function"){r[s]=p;continue}let d=(0,c.is)(a,c.Column)?a:void 0,x=d?v(d,i):u.z.any(),$=typeof p=="function"?p(x):x;t.never(d)||(r[s]=$,d&&(t.nullable(d)&&(r[s]=r[s].nullable()),t.optional(d)&&(r[s]=r[s].optional())))}return u.z.object(r)}var ae={never:e=>e?.generated?.type==="always"||e?.generatedIdentity?.type==="always",optional:e=>!e.notNull||e.notNull&&e.hasDefault,nullable:e=>!e.notNull};var U=(e,n)=>{let t=C(e);return w(t,n??{},ae)};var f=(0,g.pgTable)("plans",{id:(0,g.serial)("id").primaryKey(),name:(0,g.text)("name").notNull(),speed:(0,g.text)("speed").notNull(),price:(0,g.text)("price").notNull(),description:(0,g.text)("description"),features:(0,g.jsonb)("features").$type().notNull(),isHighlighted:(0,g.boolean)("is_highlighted").default(!1),category:(0,g.text)("category").default("internet")}),oe=U(f);var b=S(require("path"),1),{Pool:le}=R.default;if(!process.env.DATABASE_URL)throw new Error("DATABASE_URL must be set. Did you forget to provision a database?");var ce=new le({connectionString:process.env.DATABASE_URL,ssl:{rejectUnauthorized:!1}}),N=(0,F.drizzle)(ce,{schema:T});(async()=>{try{if(!process.env.DATABASE_URL){console.warn("DATABASE_URL not set, skipping migrations");return}let e=b.default.resolve(process.cwd(),"migrations"),n=await import("fs");n.existsSync(e)&&n.existsSync(b.default.join(e,"meta","_journal.json"))?(console.log("Running migrations..."),await(0,X.migrate)(N,{migrationsFolder:e}),console.log("Migrations completed.")):console.log("No migration files found or journal missing, skipping auto-migration.")}catch(e){console.error("Migration failed:",e)}})();var V=require("drizzle-orm"),_=class{async getPlans(){return await N.select().from(f)}async getPlan(n){return(await N.select().from(f).where((0,V.eq)(f.id,n)))[0]}async seedPlans(){(await N.select().from(f)).length===0&&await N.insert(f).values([{name:"B\xE1sico",speed:"300 MEGA",price:"79,90",features:["Wi-Fi Gr\xE1tis","Instala\xE7\xE3o Gr\xE1tis","Suporte 24h","Fibra \xD3ptica"],category:"internet",isHighlighted:!1},{name:"Essencial",speed:"400 MEGA",price:"89,90",features:["Wi-Fi Gr\xE1tis","Instala\xE7\xE3o Gr\xE1tis","Suporte 24h","Fibra \xD3ptica"],category:"internet",isHighlighted:!1},{name:"Intermedi\xE1rio",speed:"500 MEGA",price:"99,90",features:["Wi-Fi Gr\xE1tis","Instala\xE7\xE3o Gr\xE1tis","Suporte 24h","Fibra \xD3ptica"],category:"internet",isHighlighted:!0},{name:"Avan\xE7ado",speed:"600 MEGA",price:"109,90",features:["Wi-Fi Gr\xE1tis","Instala\xE7\xE3o Gr\xE1tis","Suporte 24h","Fibra \xD3ptica"],category:"internet",isHighlighted:!1},{name:"Ultra",speed:"700 MEGA",price:"119,90",features:["Wi-Fi Gr\xE1tis","Instala\xE7\xE3o Gr\xE1tis","Suporte 24h","Fibra \xD3ptica"],category:"internet",isHighlighted:!1},{name:"Gamer",speed:"800 MEGA",price:"129,90",features:["Wi-Fi Gr\xE1tis","Instala\xE7\xE3o Gr\xE1tis","Suporte 24h","Fibra \xD3ptica"],category:"internet",isHighlighted:!1},{name:"Premium",speed:"900 MEGA",price:"139,90",features:["Wi-Fi Gr\xE1tis","Instala\xE7\xE3o Gr\xE1tis","Suporte 24h","Fibra \xD3ptica"],category:"internet",isHighlighted:!1},{name:"Canais Light",speed:"100+ Canais",price:"17,90",features:["Canais abertos entre outros","Qualidade HD","Suporte para TV, iOS, Android e Web","Lista de canais"],category:"tv",isHighlighted:!1},{name:"Canais Plus",speed:"150+ Canais",price:"39,90",features:["Canais abertos entre outros","Qualidade HD","Suporte para TV, iOS, Android e Web","Lista de canais"],category:"tv",isHighlighted:!1},{name:"Canais Ultra",speed:"200+ Canais",price:"53,90",features:["Canais abertos entre outros","Qualidade HD","Suporte para TV, iOS, Android e Web","Lista de canais"],category:"tv",isHighlighted:!0},{name:"Canais Ultra 1P + HBO",speed:"200+ Canais + HBO",price:"70,90",features:["Canais abertos entre outros","Qualidade HD","Suporte para TV, iOS, Android e Web","Lista de canais"],category:"tv",isHighlighted:!1},{name:"C\xE2mera de Seguran\xE7a",speed:"C\xE2mera",price:"25,00",features:["Acesse de onde estiver","Aplicativo para Android e iOS","Vis\xE3o Noturna","C\xE2mera Full HD"],category:"adicionais",isHighlighted:!1},{name:"Roteador Extra",speed:"WIFI 6",price:"25,00",features:["Maior Alcance","Tecnologia Mesh","F\xE1cil Configura\xE7\xE3o","Gigabit"],category:"adicionais",isHighlighted:!1},{name:"TV Box",speed:"Android TV",price:"25,00",features:["Transforma sua TV","Acesso a Apps","Resolu\xE7\xE3o Full HD","Controle Remoto"],category:"adicionais",isHighlighted:!1}])}},M=new _;var m=require("zod"),pe={validation:m.z.object({message:m.z.string(),field:m.z.string().optional()}),notFound:m.z.object({message:m.z.string()}),internal:m.z.object({message:m.z.string()})},A={plans:{list:{method:"GET",path:"/api/plans",responses:{200:m.z.array(m.z.custom())}},get:{method:"GET",path:"/api/plans/:id",responses:{200:m.z.custom(),404:pe.notFound}}}};async function j(e,n){return n.get(A.plans.list.path,async(t,i)=>{let r=await M.getPlans();i.json(r)}),n.get(A.plans.get.path,async(t,i)=>{let r=await M.getPlan(Number(t.params.id));if(!r)return i.status(404).json({message:"Plan not found"});i.json(r)}),e}var H=S(require("express"),1),q=S(require("fs"),1),E=S(require("path"),1);function B(e){let n=E.default.resolve(__dirname,"public");if(!q.default.existsSync(n))throw new Error(`Could not find the build directory: ${n}, make sure to build the client first`);e.use(H.default.static(n)),e.use("*",(t,i)=>{i.sendFile(E.default.resolve(n,"index.html"))})}var O=require("http"),h=(0,y.default)(),L=(0,O.createServer)(h);h.use(y.default.json({verify:(e,n,t)=>{e.rawBody=t}}));h.use(y.default.urlencoded({extended:!1}));function P(e,n="express"){let t=new Date().toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",second:"2-digit",hour12:!0});console.log(`${t} [${n}] ${e}`)}h.use((e,n,t)=>{let i=Date.now(),r=e.path,s,a=n.json;n.json=function(p,...d){return s=p,a.apply(n,[p,...d])},n.on("finish",()=>{let p=Date.now()-i;if(r.startsWith("/api")){let d=`${e.method} ${r} ${n.statusCode} in ${p}ms`;s&&(d+=` :: ${JSON.stringify(s)}`),P(d)}}),t()});(async()=>{await j(L,h),h.use((n,t,i,r)=>{let s=n.status||n.statusCode||500,a=n.message||"Internal Server Error";i.status(s).json({message:a})}),B(h);let e=parseInt(process.env.PORT||"5000",10);L.listen({port:e,host:"0.0.0.0",reusePort:!0},()=>{P(`serving on port ${e}`)})})();0&&(module.exports={log});
2026-01-09T13:01:45.880752194Z [err]  /app/dist/index.cjs:1
2026-01-09T13:01:45.885326254Z [err]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
2026-01-09T13:01:45.885338097Z [err]  
2026-01-09T13:01:45.885347462Z [err]  Error: DATABASE_URL must be set. Did you forget to provision a database?
2026-01-09T13:01:45.885355754Z [err]      at Object.<anonymous> (/app/dist/index.cjs:1:5913)
2026-01-09T13:01:45.885363707Z [err]      at Module._compile (node:internal/modules/cjs/loader:1521:14)
2026-01-09T13:01:45.885371669Z [err]      at Module._extensions..js (node:internal/modules/cjs/loader:1623:10)
2026-01-09T13:01:45.885380527Z [err]      at Module.load (node:internal/modules/cjs/loader:1266:32)
2026-01-09T13:01:45.885387847Z [err]      at Module._load (node:internal/modules/cjs/loader:1091:12)
2026-01-09T13:01:45.885395587Z [err]      at Function.executeUserEntryPoint [as runMain] (node:internal/modules/run_main:164:12)
2026-01-09T13:01:45.885402449Z [err]      at node:internal/main/run_main_module:28:49
2026-01-09T13:01:45.885412263Z [err]  
2026-01-09T13:01:45.885421768Z [err]  Node.js v20.19.6
2026-01-09T13:01:45.885429372Z [err]  /app/dist/index.cjs:1
2026-01-09T13:01:45.885436699Z [err]  "use strict";var z=Object.create;var I=Object.defineProperty;var Q=Object.getOwnPropertyDescriptor;var k=Object.getOwnPropertyNames;var J=Object.getPrototypeOf,Y=Object.prototype.hasOwnProperty;var G=(e,n)=>{for(var t in n)I(e,t,{get:n[t],enumerable:!0})},D=(e,n,t,i)=>{if(n&&typeof n=="object"||typeof n=="function")for(let r of k(n))!Y.call(e,r)&&r!==t&&I(e,r,{get:()=>n[r],enumerable:!(i=Q(n,r))||i.enumerable});return e};var S=(e,n,t)=>(t=e!=null?z(J(e)):{},D(n||!e||!e.__esModule?I(t,"default",{value:e,enumerable:!0}):t,e)),K=e=>D(I({},"__esModule",{value:!0}),e);var ue={};G(ue,{log:()=>P});module.exports=K(ue);var y=S(require("express"),1);var F=require("drizzle-orm/node-postgres"),X=require("drizzle-orm/node-postgres/migrator"),R=S(require("pg"),1);var T={};G(T,{insertPlanSchema:()=>oe,plans:()=>f});var g=require("drizzle-orm/pg-core");var c=require("drizzle-orm"),u=require("zod"),o={INT8_MIN:-128,INT8_MAX:127,INT8_UNSIGNED_MAX:255,INT16_MIN:-32768,INT16_MAX:32767,INT16_UNSIGNED_MAX:65535,INT24_MIN:-8388608,INT24_MAX:8388607,INT24_UNSIGNED_MAX:16777215,INT32_MIN:-2147483648,INT32_MAX:2147483647,INT32_UNSIGNED_MAX:4294967295,INT48_MIN:-0x800000000000,INT48_MAX:0x7fffffffffff,INT48_UNSIGNED_MAX:0xffffffffffff,INT64_MIN:-9223372036854775808n,INT64_MAX:9223372036854775807n,INT64_UNSIGNED_MAX:18446744073709551615n};function l(e,n){return n.includes(e.columnType)}function Z(e){return"enumValues"in e&&Array.isArray(e.enumValues)&&e.enumValues.length>0}var ee=u.z.union([u.z.string(),u.z.number(),u.z.boolean(),u.z.null()]),te=u.z.union([ee,u.z.record(u.z.any()),u.z.array(u.z.any())]),re=u.z.custom(e=>e instanceof Buffer);function v(e,n){let t=n?.zodInstance??u.z,i=n?.coerce??{},r;return Z(e)&&(r=e.enumValues.length?t.enum(e.enumValues):t.string()),r||(l(e,["PgGeometry","PgPointTuple"])?r=t.tuple([t.number(),t.number()]):l(e,["PgGeometryObject","PgPointObject"])?r=t.object({x:t.number(),y:t.number()}):l(e,["PgHalfVector","PgVector"])?(r=t.array(t.number()),r=e.dimensions?r.length(e.dimensions):r):l(e,["PgLine"])?r=t.tuple([t.number(),t.number(),t.number()]):l(e,["PgLineABC"])?r=t.object({a:t.number(),b:t.number(),c:t.number()}):l(e,["PgArray"])?(r=t.array(v(e.baseColumn,t)),r=e.size?r.length(e.size):r):e.dataType==="array"?r=t.array(t.any()):e.dataType==="number"?r=ne(e,t,i):e.dataType==="bigint"?r=ie(e,t,i):e.dataType==="boolean"?r=i===!0||i.boolean?t.coerce.boolean():t.boolean():e.dataType==="date"?r=i===!0||i.date?t.coerce.date():t.date():e.dataType==="string"?r=se(e,t,i):e.dataType==="json"?r=te:e.dataType==="custom"?r=t.any():e.dataType==="buffer"&&(r=re)),r||(r=t.any()),r}function ne(e,n,t){let i=e.getSQLType().includes("unsigned"),r,s,a=!1;l(e,["MySqlTinyInt","SingleStoreTinyInt"])?(r=i?0:o.INT8_MIN,s=i?o.INT8_UNSIGNED_MAX:o.INT8_MAX,a=!0):l(e,["PgSmallInt","PgSmallSerial","MySqlSmallInt","SingleStoreSmallInt"])?(r=i?0:o.INT16_MIN,s=i?o.INT16_UNSIGNED_MAX:o.INT16_MAX,a=!0):l(e,["PgReal","MySqlFloat","MySqlMediumInt","SingleStoreMediumInt","SingleStoreFloat"])?(r=i?0:o.INT24_MIN,s=i?o.INT24_UNSIGNED_MAX:o.INT24_MAX,a=l(e,["MySqlMediumInt","SingleStoreMediumInt"])):l(e,["PgInteger","PgSerial","MySqlInt","SingleStoreInt"])?(r=i?0:o.INT32_MIN,s=i?o.INT32_UNSIGNED_MAX:o.INT32_MAX,a=!0):l(e,["PgDoublePrecision","MySqlReal","MySqlDouble","SingleStoreReal","SingleStoreDouble","SQLiteReal"])?(r=i?0:o.INT48_MIN,s=i?o.INT48_UNSIGNED_MAX:o.INT48_MAX):l(e,["PgBigInt53","PgBigSerial53","MySqlBigInt53","MySqlSerial","SingleStoreBigInt53","SingleStoreSerial","SQLiteInteger"])?(i=i||l(e,["MySqlSerial","SingleStoreSerial"]),r=i?0:Number.MIN_SAFE_INTEGER,s=Number.MAX_SAFE_INTEGER,a=!0):l(e,["MySqlYear","SingleStoreYear"])?(r=1901,s=2155,a=!0):(r=Number.MIN_SAFE_INTEGER,s=Number.MAX_SAFE_INTEGER);let p=t===!0||t?.number?n.coerce.number():n.number();return p=p.min(r).max(s),a?p.int():p}function ie(e,n,t){let i=e.getSQLType().includes("unsigned"),r=i?0n:o.INT64_MIN,s=i?o.INT64_UNSIGNED_MAX:o.INT64_MAX;return(t===!0||t?.bigint?n.coerce.bigint():n.bigint()).min(r).max(s)}function se(e,n,t){if(l(e,["PgUUID"]))return n.string().uuid();let i,r,s=!1;l(e,["PgVarchar","SQLiteText"])?i=e.length:l(e,["MySqlVarChar","SingleStoreVarChar"])?i=e.length??o.INT16_UNSIGNED_MAX:l(e,["MySqlText","SingleStoreText"])&&(e.textType==="longtext"?i=o.INT32_UNSIGNED_MAX:e.textType==="mediumtext"?i=o.INT24_UNSIGNED_MAX:e.textType==="text"?i=o.INT16_UNSIGNED_MAX:i=o.INT8_UNSIGNED_MAX),l(e,["PgChar","MySqlChar","SingleStoreChar"])&&(i=e.length,s=!0),l(e,["PgBinaryVector"])&&(r=/^[01]+$/,i=e.dimensions);let a=t===!0||t?.string?n.coerce.string():n.string();return a=r?a.regex(r):a,i&&s?a.length(i):i?a.max(i):a}function C(e){return(0,c.isTable)(e)?(0,c.getTableColumns)(e):(0,c.getViewSelectedFields)(e)}function w(e,n,t,i){let r={};for(let[s,a]of Object.entries(e)){if(!(0,c.is)(a,c.Column)&&!(0,c.is)(a,c.SQL)&&!(0,c.is)(a,c.SQL.Aliased)&&typeof a=="object"){let W=(0,c.isTable)(a)||(0,c.isView)(a)?C(a):a;r[s]=w(W,n[s]??{},t,i);continue}let p=n[s];if(p!==void 0&&typeof p!="function"){r[s]=p;continue}let d=(0,c.is)(a,c.Column)?a:void 0,x=d?v(d,i):u.z.any(),$=typeof p=="function"?p(x):x;t.never(d)||(r[s]=$,d&&(t.nullable(d)&&(r[s]=r[s].nullable()),t.optional(d)&&(r[s]=r[s].optional())))}return u.z.object(r)}var ae={never:e=>e?.generated?.type==="always"||e?.generatedIdentity?.type==="always",optional:e=>!e.notNull||e.notNull&&e.hasDefault,nullable:e=>!e.notNull};var U=(e,n)=>{let t=C(e);return w(t,n??{},ae)};var f=(0,g.pgTable)("plans",{id:(0,g.serial)("id").primaryKey(),name:(0,g.text)("name").notNull(),speed:(0,g.text)("speed").notNull(),price:(0,g.text)("price").notNull(),description:(0,g.text)("description"),features:(0,g.jsonb)("features").$type().notNull(),isHighlighted:(0,g.boolean)("is_highlighted").default(!1),category:(0,g.text)("category").default("internet")}),oe=U(f);var b=S(require("path"),1),{Pool:le}=R.default;if(!process.env.DATABASE_URL)throw new Error("DATABASE_URL must be set. Did you forget to provision a database?");var ce=new le({connectionString:process.env.DATABASE_URL,ssl:{rejectUnauthorized:!1}}),N=(0,F.drizzle)(ce,{schema:T});(async()=>{try{if(!process.env.DATABASE_URL){console.warn("DATABASE_URL not set, skipping migrations");return}let e=b.default.resolve(process.cwd(),"migrations"),n=await import("fs");n.existsSync(e)&&n.existsSync(b.default.join(e,"meta","_journal.json"))?(console.log("Running migrations..."),await(0,X.migrate)(N,{migrationsFolder:e}),console.log("Migrations completed.")):console.log("No migration files found or journal missing, skipping auto-migration.")}catch(e){console.error("Migration failed:",e)}})();var V=require("drizzle-orm"),_=class{async getPlans(){return await N.select().from(f)}async getPlan(n){return(await N.select().from(f).where((0,V.eq)(f.id,n)))[0]}async seedPlans(){(await N.select().from(f)).length===0&&await N.insert(f).values([{name:"B\xE1sico",speed:"300 MEGA",price:"79,90",features:["Wi-Fi Gr\xE1tis","Instala\xE7\xE3o Gr\xE1tis","Suporte 24h","Fibra \xD3ptica"],category:"internet",isHighlighted:!1},{name:"Essencial",speed:"400 MEGA",price:"89,90",features:["Wi-Fi Gr\xE1tis","Instala\xE7\xE3o Gr\xE1tis","Suporte 24h","Fibra \xD3ptica"],category:"internet",isHighlighted:!1},{name:"Intermedi\xE1rio",speed:"500 MEGA",price:"99,90",features:["Wi-Fi Gr\xE1tis","Instala\xE7\xE3o Gr\xE1tis","Suporte 24h","Fibra \xD3ptica"],category:"internet",isHighlighted:!0},{name:"Avan\xE7ado",speed:"600 MEGA",price:"109,90",features:["Wi-Fi Gr\xE1tis","Instala\xE7\xE3o Gr\xE1tis","Suporte 24h","Fibra \xD3ptica"],category:"internet",isHighlighted:!1},{name:"Ultra",speed:"700 MEGA",price:"119,90",features:["Wi-Fi Gr\xE1tis","Instala\xE7\xE3o Gr\xE1tis","Suporte 24h","Fibra \xD3ptica"],category:"internet",isHighlighted:!1},{name:"Gamer",speed:"800 MEGA",price:"129,90",features:["Wi-Fi Gr\xE1tis","Instala\xE7\xE3o Gr\xE1tis","Suporte 24h","Fibra \xD3ptica"],category:"internet",isHighlighted:!1},{name:"Premium",speed:"900 MEGA",price:"139,90",features:["Wi-Fi Gr\xE1tis","Instala\xE7\xE3o Gr\xE1tis","Suporte 24h","Fibra \xD3ptica"],category:"internet",isHighlighted:!1},{name:"Canais Light",speed:"100+ Canais",price:"17,90",features:["Canais abertos entre outros","Qualidade HD","Suporte para TV, iOS, Android e Web","Lista de canais"],category:"tv",isHighlighted:!1},{name:"Canais Plus",speed:"150+ Canais",price:"39,90",features:["Canais abertos entre outros","Qualidade HD","Suporte para TV, iOS, Android e Web","Lista de canais"],category:"tv",isHighlighted:!1},{name:"Canais Ultra",speed:"200+ Canais",price:"53,90",features:["Canais abertos entre outros","Qualidade HD","Suporte para TV, iOS, Android e Web","Lista de canais"],category:"tv",isHighlighted:!0},{name:"Canais Ultra 1P + HBO",speed:"200+ Canais + HBO",price:"70,90",features:["Canais abertos entre outros","Qualidade HD","Suporte para TV, iOS, Android e Web","Lista de canais"],category:"tv",isHighlighted:!1},{name:"C\xE2mera de Seguran\xE7a",speed:"C\xE2mera",price:"25,00",features:["Acesse de onde estiver","Aplicativo para Android e iOS","Vis\xE3o Noturna","C\xE2mera Full HD"],category:"adicionais",isHighlighted:!1},{name:"Roteador Extra",speed:"WIFI 6",price:"25,00",features:["Maior Alcance","Tecnologia Mesh","F\xE1cil Configura\xE7\xE3o","Gigabit"],category:"adicionais",isHighlighted:!1},{name:"TV Box",speed:"Android TV",price:"25,00",features:["Transforma sua TV","Acesso a Apps","Resolu\xE7\xE3o Full HD","Controle Remoto"],category:"adicionais",isHighlighted:!1}])}},M=new _;var m=require("zod"),pe={validation:m.z.object({message:m.z.string(),field:m.z.string().optional()}),notFound:m.z.object({message:m.z.string()}),internal:m.z.object({message:m.z.string()})},A={plans:{list:{method:"GET",path:"/api/plans",responses:{200:m.z.array(m.z.custom())}},get:{method:"GET",path:"/api/plans/:id",responses:{200:m.z.custom(),404:pe.notFound}}}};async function j(e,n){return n.get(A.plans.list.path,async(t,i)=>{let r=await M.getPlans();i.json(r)}),n.get(A.plans.get.path,async(t,i)=>{let r=await M.getPlan(Number(t.params.id));if(!r)return i.status(404).json({message:"Plan not found"});i.json(r)}),e}var H=S(require("express"),1),q=S(require("fs"),1),E=S(require("path"),1);function B(e){let n=E.default.resolve(__dirname,"public");if(!q.default.existsSync(n))throw new Error(`Could not find the build directory: ${n}, make sure to build the client first`);e.use(H.default.static(n)),e.use("*",(t,i)=>{i.sendFile(E.default.resolve(n,"index.html"))})}var O=require("http"),h=(0,y.default)(),L=(0,O.createServer)(h);h.use(y.default.json({verify:(e,n,t)=>{e.rawBody=t}}));h.use(y.default.urlencoded({extended:!1}));function P(e,n="express"){let t=new Date().toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",second:"2-digit",hour12:!0});console.log(`${t} [${n}] ${e}`)}h.use((e,n,t)=>{let i=Date.now(),r=e.path,s,a=n.json;n.json=function(p,...d){return s=p,a.apply(n,[p,...d])},n.on("finish",()=>{let p=Date.now()-i;if(r.startsWith("/api")){let d=`${e.method} ${r} ${n.statusCode} in ${p}ms`;s&&(d+=` :: ${JSON.stringify(s)}`),P(d)}}),t()});(async()=>{await j(L,h),h.use((n,t,i,r)=>{let s=n.status||n.statusCode||500,a=n.message||"Internal Server Error";i.status(s).json({message:a})}),B(h);let e=parseInt(process.env.PORT||"5000",10);L.listen({port:e,host:"0.0.0.0",reusePort:!0},()=>{P(`serving on port ${e}`)})})();0&&(module.exports={log});
2026-01-09T13:01:45.885444727Z [err]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
2026-01-09T13:01:45.885452217Z [err]  
2026-01-09T13:01:45.885460077Z [err]  Error: DATABASE_URL must be set. Did you forget to provision a database?
2026-01-09T13:01:45.885467698Z [err]      at Object.<anonymous> (/app/dist/index.cjs:1:5913)
2026-01-09T13:01:45.885475224Z [err]      at Module._compile (node:internal/modules/cjs/loader:1521:14)
2026-01-09T13:01:45.885482130Z [err]      at Module._extensions..js (node:internal/modules/cjs/loader:1623:10)
2026-01-09T13:01:45.885489340Z [err]      at Module.load (node:internal/modules/cjs/loader:1266:32)
2026-01-09T13:01:45.885496694Z [err]      at Module._load (node:internal/modules/cjs/loader:1091:12)
2026-01-09T13:01:45.885504504Z [err]      at Function.executeUserEntryPoint [as runMain] (node:internal/modules/run_main:164:12)
2026-01-09T13:01:45.885512132Z [err]      at node:internal/main/run_main_module:28:49
2026-01-09T13:01:45.885519797Z [err]  
2026-01-09T13:01:45.885526966Z [err]  Node.js v20.19.6
2026-01-09T13:01:46.384710124Z [err]  /app/dist/index.cjs:1
2026-01-09T13:01:46.388551105Z [err]  "use strict";var z=Object.create;var I=Object.defineProperty;var Q=Object.getOwnPropertyDescriptor;var k=Object.getOwnPropertyNames;var J=Object.getPrototypeOf,Y=Object.prototype.hasOwnProperty;var G=(e,n)=>{for(var t in n)I(e,t,{get:n[t],enumerable:!0})},D=(e,n,t,i)=>{if(n&&typeof n=="object"||typeof n=="function")for(let r of k(n))!Y.call(e,r)&&r!==t&&I(e,r,{get:()=>n[r],enumerable:!(i=Q(n,r))||i.enumerable});return e};var S=(e,n,t)=>(t=e!=null?z(J(e)):{},D(n||!e||!e.__esModule?I(t,"default",{value:e,enumerable:!0}):t,e)),K=e=>D(I({},"__esModule",{value:!0}),e);var ue={};G(ue,{log:()=>P});module.exports=K(ue);var y=S(require("express"),1);var F=require("drizzle-orm/node-postgres"),X=require("drizzle-orm/node-postgres/migrator"),R=S(require("pg"),1);var T={};G(T,{insertPlanSchema:()=>oe,plans:()=>f});var g=require("drizzle-orm/pg-core");var c=require("drizzle-orm"),u=require("zod"),o={INT8_MIN:-128,INT8_MAX:127,INT8_UNSIGNED_MAX:255,INT16_MIN:-32768,INT16_MAX:32767,INT16_UNSIGNED_MAX:65535,INT24_MIN:-8388608,INT24_MAX:8388607,INT24_UNSIGNED_MAX:16777215,INT32_MIN:-2147483648,INT32_MAX:2147483647,INT32_UNSIGNED_MAX:4294967295,INT48_MIN:-0x800000000000,INT48_MAX:0x7fffffffffff,INT48_UNSIGNED_MAX:0xffffffffffff,INT64_MIN:-9223372036854775808n,INT64_MAX:9223372036854775807n,INT64_UNSIGNED_MAX:18446744073709551615n};function l(e,n){return n.includes(e.columnType)}function Z(e){return"enumValues"in e&&Array.isArray(e.enumValues)&&e.enumValues.length>0}var ee=u.z.union([u.z.string(),u.z.number(),u.z.boolean(),u.z.null()]),te=u.z.union([ee,u.z.record(u.z.any()),u.z.array(u.z.any())]),re=u.z.custom(e=>e instanceof Buffer);function v(e,n){let t=n?.zodInstance??u.z,i=n?.coerce??{},r;return Z(e)&&(r=e.enumValues.length?t.enum(e.enumValues):t.string()),r||(l(e,["PgGeometry","PgPointTuple"])?r=t.tuple([t.number(),t.number()]):l(e,["PgGeometryObject","PgPointObject"])?r=t.object({x:t.number(),y:t.number()}):l(e,["PgHalfVector","PgVector"])?(r=t.array(t.number()),r=e.dimensions?r.length(e.dimensions):r):l(e,["PgLine"])?r=t.tuple([t.number(),t.number(),t.number()]):l(e,["PgLineABC"])?r=t.object({a:t.number(),b:t.number(),c:t.number()}):l(e,["PgArray"])?(r=t.array(v(e.baseColumn,t)),r=e.size?r.length(e.size):r):e.dataType==="array"?r=t.array(t.any()):e.dataType==="number"?r=ne(e,t,i):e.dataType==="bigint"?r=ie(e,t,i):e.dataType==="boolean"?r=i===!0||i.boolean?t.coerce.boolean():t.boolean():e.dataType==="date"?r=i===!0||i.date?t.coerce.date():t.date():e.dataType==="string"?r=se(e,t,i):e.dataType==="json"?r=te:e.dataType==="custom"?r=t.any():e.dataType==="buffer"&&(r=re)),r||(r=t.any()),r}function ne(e,n,t){let i=e.getSQLType().includes("unsigned"),r,s,a=!1;l(e,["MySqlTinyInt","SingleStoreTinyInt"])?(r=i?0:o.INT8_MIN,s=i?o.INT8_UNSIGNED_MAX:o.INT8_MAX,a=!0):l(e,["PgSmallInt","PgSmallSerial","MySqlSmallInt","SingleStoreSmallInt"])?(r=i?0:o.INT16_MIN,s=i?o.INT16_UNSIGNED_MAX:o.INT16_MAX,a=!0):l(e,["PgReal","MySqlFloat","MySqlMediumInt","SingleStoreMediumInt","SingleStoreFloat"])?(r=i?0:o.INT24_MIN,s=i?o.INT24_UNSIGNED_MAX:o.INT24_MAX,a=l(e,["MySqlMediumInt","SingleStoreMediumInt"])):l(e,["PgInteger","PgSerial","MySqlInt","SingleStoreInt"])?(r=i?0:o.INT32_MIN,s=i?o.INT32_UNSIGNED_MAX:o.INT32_MAX,a=!0):l(e,["PgDoublePrecision","MySqlReal","MySqlDouble","SingleStoreReal","SingleStoreDouble","SQLiteReal"])?(r=i?0:o.INT48_MIN,s=i?o.INT48_UNSIGNED_MAX:o.INT48_MAX):l(e,["PgBigInt53","PgBigSerial53","MySqlBigInt53","MySqlSerial","SingleStoreBigInt53","SingleStoreSerial","SQLiteInteger"])?(i=i||l(e,["MySqlSerial","SingleStoreSerial"]),r=i?0:Number.MIN_SAFE_INTEGER,s=Number.MAX_SAFE_INTEGER,a=!0):l(e,["MySqlYear","SingleStoreYear"])?(r=1901,s=2155,a=!0):(r=Number.MIN_SAFE_INTEGER,s=Number.MAX_SAFE_INTEGER);let p=t===!0||t?.number?n.coerce.number():n.number();return p=p.min(r).max(s),a?p.int():p}function ie(e,n,t){let i=e.getSQLType().includes("unsigned"),r=i?0n:o.INT64_MIN,s=i?o.INT64_UNSIGNED_MAX:o.INT64_MAX;return(t===!0||t?.bigint?n.coerce.bigint():n.bigint()).min(r).max(s)}function se(e,n,t){if(l(e,["PgUUID"]))return n.string().uuid();let i,r,s=!1;l(e,["PgVarchar","SQLiteText"])?i=e.length:l(e,["MySqlVarChar","SingleStoreVarChar"])?i=e.length??o.INT16_UNSIGNED_MAX:l(e,["MySqlText","SingleStoreText"])&&(e.textType==="longtext"?i=o.INT32_UNSIGNED_MAX:e.textType==="mediumtext"?i=o.INT24_UNSIGNED_MAX:e.textType==="text"?i=o.INT16_UNSIGNED_MAX:i=o.INT8_UNSIGNED_MAX),l(e,["PgChar","MySqlChar","SingleStoreChar"])&&(i=e.length,s=!0),l(e,["PgBinaryVector"])&&(r=/^[01]+$/,i=e.dimensions);let a=t===!0||t?.string?n.coerce.string():n.string();return a=r?a.regex(r):a,i&&s?a.length(i):i?a.max(i):a}function C(e){return(0,c.isTable)(e)?(0,c.getTableColumns)(e):(0,c.getViewSelectedFields)(e)}function w(e,n,t,i){let r={};for(let[s,a]of Object.entries(e)){if(!(0,c.is)(a,c.Column)&&!(0,c.is)(a,c.SQL)&&!(0,c.is)(a,c.SQL.Aliased)&&typeof a=="object"){let W=(0,c.isTable)(a)||(0,c.isView)(a)?C(a):a;r[s]=w(W,n[s]??{},t,i);continue}let p=n[s];if(p!==void 0&&typeof p!="function"){r[s]=p;continue}let d=(0,c.is)(a,c.Column)?a:void 0,x=d?v(d,i):u.z.any(),$=typeof p=="function"?p(x):x;t.never(d)||(r[s]=$,d&&(t.nullable(d)&&(r[s]=r[s].nullable()),t.optional(d)&&(r[s]=r[s].optional())))}return u.z.object(r)}var ae={never:e=>e?.generated?.type==="always"||e?.generatedIdentity?.type==="always",optional:e=>!e.notNull||e.notNull&&e.hasDefault,nullable:e=>!e.notNull};var U=(e,n)=>{let t=C(e);return w(t,n??{},ae)};var f=(0,g.pgTable)("plans",{id:(0,g.serial)("id").primaryKey(),name:(0,g.text)("name").notNull(),speed:(0,g.text)("speed").notNull(),price:(0,g.text)("price").notNull(),description:(0,g.text)("description"),features:(0,g.jsonb)("features").$type().notNull(),isHighlighted:(0,g.boolean)("is_highlighted").default(!1),category:(0,g.text)("category").default("internet")}),oe=U(f);var b=S(require("path"),1),{Pool:le}=R.default;if(!process.env.DATABASE_URL)throw new Error("DATABASE_URL must be set. Did you forget to provision a database?");var ce=new le({connectionString:process.env.DATABASE_URL,ssl:{rejectUnauthorized:!1}}),N=(0,F.drizzle)(ce,{schema:T});(async()=>{try{if(!process.env.DATABASE_URL){console.warn("DATABASE_URL not set, skipping migrations");return}let e=b.default.resolve(process.cwd(),"migrations"),n=await import("fs");n.existsSync(e)&&n.existsSync(b.default.join(e,"meta","_journal.json"))?(console.log("Running migrations..."),await(0,X.migrate)(N,{migrationsFolder:e}),console.log("Migrations completed.")):console.log("No migration files found or journal missing, skipping auto-migration.")}catch(e){console.error("Migration failed:",e)}})();var V=require("drizzle-orm"),_=class{async getPlans(){return await N.select().from(f)}async getPlan(n){return(await N.select().from(f).where((0,V.eq)(f.id,n)))[0]}async seedPlans(){(await N.select().from(f)).length===0&&await N.insert(f).values([{name:"B\xE1sico",speed:"300 MEGA",price:"79,90",features:["Wi-Fi Gr\xE1tis","Instala\xE7\xE3o Gr\xE1tis","Suporte 24h","Fibra \xD3ptica"],category:"internet",isHighlighted:!1},{name:"Essencial",speed:"400 MEGA",price:"89,90",features:["Wi-Fi Gr\xE1tis","Instala\xE7\xE3o Gr\xE1tis","Suporte 24h","Fibra \xD3ptica"],category:"internet",isHighlighted:!1},{name:"Intermedi\xE1rio",speed:"500 MEGA",price:"99,90",features:["Wi-Fi Gr\xE1tis","Instala\xE7\xE3o Gr\xE1tis","Suporte 24h","Fibra \xD3ptica"],category:"internet",isHighlighted:!0},{name:"Avan\xE7ado",speed:"600 MEGA",price:"109,90",features:["Wi-Fi Gr\xE1tis","Instala\xE7\xE3o Gr\xE1tis","Suporte 24h","Fibra \xD3ptica"],category:"internet",isHighlighted:!1},{name:"Ultra",speed:"700 MEGA",price:"119,90",features:["Wi-Fi Gr\xE1tis","Instala\xE7\xE3o Gr\xE1tis","Suporte 24h","Fibra \xD3ptica"],category:"internet",isHighlighted:!1},{name:"Gamer",speed:"800 MEGA",price:"129,90",features:["Wi-Fi Gr\xE1tis","Instala\xE7\xE3o Gr\xE1tis","Suporte 24h","Fibra \xD3ptica"],category:"internet",isHighlighted:!1},{name:"Premium",speed:"900 MEGA",price:"139,90",features:["Wi-Fi Gr\xE1tis","Instala\xE7\xE3o Gr\xE1tis","Suporte 24h","Fibra \xD3ptica"],category:"internet",isHighlighted:!1},{name:"Canais Light",speed:"100+ Canais",price:"17,90",features:["Canais abertos entre outros","Qualidade HD","Suporte para TV, iOS, Android e Web","Lista de canais"],category:"tv",isHighlighted:!1},{name:"Canais Plus",speed:"150+ Canais",price:"39,90",features:["Canais abertos entre outros","Qualidade HD","Suporte para TV, iOS, Android e Web","Lista de canais"],category:"tv",isHighlighted:!1},{name:"Canais Ultra",speed:"200+ Canais",price:"53,90",features:["Canais abertos entre outros","Qualidade HD","Suporte para TV, iOS, Android e Web","Lista de canais"],category:"tv",isHighlighted:!0},{name:"Canais Ultra 1P + HBO",speed:"200+ Canais + HBO",price:"70,90",features:["Canais abertos entre outros","Qualidade HD","Suporte para TV, iOS, Android e Web","Lista de canais"],category:"tv",isHighlighted:!1},{name:"C\xE2mera de Seguran\xE7a",speed:"C\xE2mera",price:"25,00",features:["Acesse de onde estiver","Aplicativo para Android e iOS","Vis\xE3o Noturna","C\xE2mera Full HD"],category:"adicionais",isHighlighted:!1},{name:"Roteador Extra",speed:"WIFI 6",price:"25,00",features:["Maior Alcance","Tecnologia Mesh","F\xE1cil Configura\xE7\xE3o","Gigabit"],category:"adicionais",isHighlighted:!1},{name:"TV Box",speed:"Android TV",price:"25,00",features:["Transforma sua TV","Acesso a Apps","Resolu\xE7\xE3o Full HD","Controle Remoto"],category:"adicionais",isHighlighted:!1}])}},M=new _;var m=require("zod"),pe={validation:m.z.object({message:m.z.string(),field:m.z.string().optional()}),notFound:m.z.object({message:m.z.string()}),internal:m.z.object({message:m.z.string()})},A={plans:{list:{method:"GET",path:"/api/plans",responses:{200:m.z.array(m.z.custom())}},get:{method:"GET",path:"/api/plans/:id",responses:{200:m.z.custom(),404:pe.notFound}}}};async function j(e,n){return n.get(A.plans.list.path,async(t,i)=>{let r=await M.getPlans();i.json(r)}),n.get(A.plans.get.path,async(t,i)=>{let r=await M.getPlan(Number(t.params.id));if(!r)return i.status(404).json({message:"Plan not found"});i.json(r)}),e}var H=S(require("express"),1),q=S(require("fs"),1),E=S(require("path"),1);function B(e){let n=E.default.resolve(__dirname,"public");if(!q.default.existsSync(n))throw new Error(`Could not find the build directory: ${n}, make sure to build the client first`);e.use(H.default.static(n)),e.use("*",(t,i)=>{i.sendFile(E.default.resolve(n,"index.html"))})}var O=require("http"),h=(0,y.default)(),L=(0,O.createServer)(h);h.use(y.default.json({verify:(e,n,t)=>{e.rawBody=t}}));h.use(y.default.urlencoded({extended:!1}));function P(e,n="express"){let t=new Date().toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",second:"2-digit",hour12:!0});console.log(`${t} [${n}] ${e}`)}h.use((e,n,t)=>{let i=Date.now(),r=e.path,s,a=n.json;n.json=function(p,...d){return s=p,a.apply(n,[p,...d])},n.on("finish",()=>{let p=Date.now()-i;if(r.startsWith("/api")){let d=`${e.method} ${r} ${n.statusCode} in ${p}ms`;s&&(d+=` :: ${JSON.stringify(s)}`),P(d)}}),t()});(async()=>{await j(L,h),h.use((n,t,i,r)=>{let s=n.status||n.statusCode||500,a=n.message||"Internal Server Error";i.status(s).json({message:a})}),B(h);let e=parseInt(process.env.PORT||"5000",10);L.listen({port:e,host:"0.0.0.0",reusePort:!0},()=>{P(`serving on port ${e}`)})})();0&&(module.exports={log});
2026-01-09T13:01:46.388562175Z [err]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
2026-01-09T13:01:46.388568798Z [err]  
2026-01-09T13:01:46.388577603Z [err]  Error: DATABASE_URL must be set. Did you forget to provision a database?
2026-01-09T13:01:46.388583762Z [err]      at Object.<anonymous> (/app/dist/index.cjs:1:5913)
2026-01-09T13:01:46.388589668Z [err]      at Module._compile (node:internal/modules/cjs/loader:1521:14)
2026-01-09T13:01:46.388595173Z [err]      at Module._extensions..js (node:internal/modules/cjs/loader:1623:10)
2026-01-09T13:01:46.388600577Z [err]      at Module.load (node:internal/modules/cjs/loader:1266:32)
2026-01-09T13:01:46.388605882Z [err]      at Module._load (node:internal/modules/cjs/loader:1091:12)
2026-01-09T13:01:46.388611769Z [err]      at Function.executeUserEntryPoint [as runMain] (node:internal/modules/run_main:164:12)
2026-01-09T13:01:46.388617435Z [err]      at node:internal/main/run_main_module:28:49
2026-01-09T13:01:46.388622630Z [err]  
2026-01-09T13:01:46.388627679Z [err]  Node.js v20.19.6
2026-01-09T13:01:47.232890180Z [err]  /app/dist/index.cjs:1
2026-01-09T13:01:47.233847084Z [err]  "use strict";var z=Object.create;var I=Object.defineProperty;var Q=Object.getOwnPropertyDescriptor;var k=Object.getOwnPropertyNames;var J=Object.getPrototypeOf,Y=Object.prototype.hasOwnProperty;var G=(e,n)=>{for(var t in n)I(e,t,{get:n[t],enumerable:!0})},D=(e,n,t,i)=>{if(n&&typeof n=="object"||typeof n=="function")for(let r of k(n))!Y.call(e,r)&&r!==t&&I(e,r,{get:()=>n[r],enumerable:!(i=Q(n,r))||i.enumerable});return e};var S=(e,n,t)=>(t=e!=null?z(J(e)):{},D(n||!e||!e.__esModule?I(t,"default",{value:e,enumerable:!0}):t,e)),K=e=>D(I({},"__esModule",{value:!0}),e);var ue={};G(ue,{log:()=>P});module.exports=K(ue);var y=S(require("express"),1);var F=require("drizzle-orm/node-postgres"),X=require("drizzle-orm/node-postgres/migrator"),R=S(require("pg"),1);var T={};G(T,{insertPlanSchema:()=>oe,plans:()=>f});var g=require("drizzle-orm/pg-core");var c=require("drizzle-orm"),u=require("zod"),o={INT8_MIN:-128,INT8_MAX:127,INT8_UNSIGNED_MAX:255,INT16_MIN:-32768,INT16_MAX:32767,INT16_UNSIGNED_MAX:65535,INT24_MIN:-8388608,INT24_MAX:8388607,INT24_UNSIGNED_MAX:16777215,INT32_MIN:-2147483648,INT32_MAX:2147483647,INT32_UNSIGNED_MAX:4294967295,INT48_MIN:-0x800000000000,INT48_MAX:0x7fffffffffff,INT48_UNSIGNED_MAX:0xffffffffffff,INT64_MIN:-9223372036854775808n,INT64_MAX:9223372036854775807n,INT64_UNSIGNED_MAX:18446744073709551615n};function l(e,n){return n.includes(e.columnType)}function Z(e){return"enumValues"in e&&Array.isArray(e.enumValues)&&e.enumValues.length>0}var ee=u.z.union([u.z.string(),u.z.number(),u.z.boolean(),u.z.null()]),te=u.z.union([ee,u.z.record(u.z.any()),u.z.array(u.z.any())]),re=u.z.custom(e=>e instanceof Buffer);function v(e,n){let t=n?.zodInstance??u.z,i=n?.coerce??{},r;return Z(e)&&(r=e.enumValues.length?t.enum(e.enumValues):t.string()),r||(l(e,["PgGeometry","PgPointTuple"])?r=t.tuple([t.number(),t.number()]):l(e,["PgGeometryObject","PgPointObject"])?r=t.object({x:t.number(),y:t.number()}):l(e,["PgHalfVector","PgVector"])?(r=t.array(t.number()),r=e.dimensions?r.length(e.dimensions):r):l(e,["PgLine"])?r=t.tuple([t.number(),t.number(),t.number()]):l(e,["PgLineABC"])?r=t.object({a:t.number(),b:t.number(),c:t.number()}):l(e,["PgArray"])?(r=t.array(v(e.baseColumn,t)),r=e.size?r.length(e.size):r):e.dataType==="array"?r=t.array(t.any()):e.dataType==="number"?r=ne(e,t,i):e.dataType==="bigint"?r=ie(e,t,i):e.dataType==="boolean"?r=i===!0||i.boolean?t.coerce.boolean():t.boolean():e.dataType==="date"?r=i===!0||i.date?t.coerce.date():t.date():e.dataType==="string"?r=se(e,t,i):e.dataType==="json"?r=te:e.dataType==="custom"?r=t.any():e.dataType==="buffer"&&(r=re)),r||(r=t.any()),r}function ne(e,n,t){let i=e.getSQLType().includes("unsigned"),r,s,a=!1;l(e,["MySqlTinyInt","SingleStoreTinyInt"])?(r=i?0:o.INT8_MIN,s=i?o.INT8_UNSIGNED_MAX:o.INT8_MAX,a=!0):l(e,["PgSmallInt","PgSmallSerial","MySqlSmallInt","SingleStoreSmallInt"])?(r=i?0:o.INT16_MIN,s=i?o.INT16_UNSIGNED_MAX:o.INT16_MAX,a=!0):l(e,["PgReal","MySqlFloat","MySqlMediumInt","SingleStoreMediumInt","SingleStoreFloat"])?(r=i?0:o.INT24_MIN,s=i?o.INT24_UNSIGNED_MAX:o.INT24_MAX,a=l(e,["MySqlMediumInt","SingleStoreMediumInt"])):l(e,["PgInteger","PgSerial","MySqlInt","SingleStoreInt"])?(r=i?0:o.INT32_MIN,s=i?o.INT32_UNSIGNED_MAX:o.INT32_MAX,a=!0):l(e,["PgDoublePrecision","MySqlReal","MySqlDouble","SingleStoreReal","SingleStoreDouble","SQLiteReal"])?(r=i?0:o.INT48_MIN,s=i?o.INT48_UNSIGNED_MAX:o.INT48_MAX):l(e,["PgBigInt53","PgBigSerial53","MySqlBigInt53","MySqlSerial","SingleStoreBigInt53","SingleStoreSerial","SQLiteInteger"])?(i=i||l(e,["MySqlSerial","SingleStoreSerial"]),r=i?0:Number.MIN_SAFE_INTEGER,s=Number.MAX_SAFE_INTEGER,a=!0):l(e,["MySqlYear","SingleStoreYear"])?(r=1901,s=2155,a=!0):(r=Number.MIN_SAFE_INTEGER,s=Number.MAX_SAFE_INTEGER);let p=t===!0||t?.number?n.coerce.number():n.number();return p=p.min(r).max(s),a?p.int():p}function ie(e,n,t){let i=e.getSQLType().includes("unsigned"),r=i?0n:o.INT64_MIN,s=i?o.INT64_UNSIGNED_MAX:o.INT64_MAX;return(t===!0||t?.bigint?n.coerce.bigint():n.bigint()).min(r).max(s)}function se(e,n,t){if(l(e,["PgUUID"]))return n.string().uuid();let i,r,s=!1;l(e,["PgVarchar","SQLiteText"])?i=e.length:l(e,["MySqlVarChar","SingleStoreVarChar"])?i=e.length??o.INT16_UNSIGNED_MAX:l(e,["MySqlText","SingleStoreText"])&&(e.textType==="longtext"?i=o.INT32_UNSIGNED_MAX:e.textType==="mediumtext"?i=o.INT24_UNSIGNED_MAX:e.textType==="text"?i=o.INT16_UNSIGNED_MAX:i=o.INT8_UNSIGNED_MAX),l(e,["PgChar","MySqlChar","SingleStoreChar"])&&(i=e.length,s=!0),l(e,["PgBinaryVector"])&&(r=/^[01]+$/,i=e.dimensions);let a=t===!0||t?.string?n.coerce.string():n.string();return a=r?a.regex(r):a,i&&s?a.length(i):i?a.max(i):a}function C(e){return(0,c.isTable)(e)?(0,c.getTableColumns)(e):(0,c.getViewSelectedFields)(e)}function w(e,n,t,i){let r={};for(let[s,a]of Object.entries(e)){if(!(0,c.is)(a,c.Column)&&!(0,c.is)(a,c.SQL)&&!(0,c.is)(a,c.SQL.Aliased)&&typeof a=="object"){let W=(0,c.isTable)(a)||(0,c.isView)(a)?C(a):a;r[s]=w(W,n[s]??{},t,i);continue}let p=n[s];if(p!==void 0&&typeof p!="function"){r[s]=p;continue}let d=(0,c.is)(a,c.Column)?a:void 0,x=d?v(d,i):u.z.any(),$=typeof p=="function"?p(x):x;t.never(d)||(r[s]=$,d&&(t.nullable(d)&&(r[s]=r[s].nullable()),t.optional(d)&&(r[s]=r[s].optional())))}return u.z.object(r)}var ae={never:e=>e?.generated?.type==="always"||e?.generatedIdentity?.type==="always",optional:e=>!e.notNull||e.notNull&&e.hasDefault,nullable:e=>!e.notNull};var U=(e,n)=>{let t=C(e);return w(t,n??{},ae)};var f=(0,g.pgTable)("plans",{id:(0,g.serial)("id").primaryKey(),name:(0,g.text)("name").notNull(),speed:(0,g.text)("speed").notNull(),price:(0,g.text)("price").notNull(),description:(0,g.text)("description"),features:(0,g.jsonb)("features").$type().notNull(),isHighlighted:(0,g.boolean)("is_highlighted").default(!1),category:(0,g.text)("category").default("internet")}),oe=U(f);var b=S(require("path"),1),{Pool:le}=R.default;if(!process.env.DATABASE_URL)throw new Error("DATABASE_URL must be set. Did you forget to provision a database?");var ce=new le({connectionString:process.env.DATABASE_URL,ssl:{rejectUnauthorized:!1}}),N=(0,F.drizzle)(ce,{schema:T});(async()=>{try{if(!process.env.DATABASE_URL){console.warn("DATABASE_URL not set, skipping migrations");return}let e=b.default.resolve(process.cwd(),"migrations"),n=await import("fs");n.existsSync(e)&&n.existsSync(b.default.join(e,"meta","_journal.json"))?(console.log("Running migrations..."),await(0,X.migrate)(N,{migrationsFolder:e}),console.log("Migrations completed.")):console.log("No migration files found or journal missing, skipping auto-migration.")}catch(e){console.error("Migration failed:",e)}})();var V=require("drizzle-orm"),_=class{async getPlans(){return await N.select().from(f)}async getPlan(n){return(await N.select().from(f).where((0,V.eq)(f.id,n)))[0]}async seedPlans(){(await N.select().from(f)).length===0&&await N.insert(f).values([{name:"B\xE1sico",speed:"300 MEGA",price:"79,90",features:["Wi-Fi Gr\xE1tis","Instala\xE7\xE3o Gr\xE1tis","Suporte 24h","Fibra \xD3ptica"],category:"internet",isHighlighted:!1},{name:"Essencial",speed:"400 MEGA",price:"89,90",features:["Wi-Fi Gr\xE1tis","Instala\xE7\xE3o Gr\xE1tis","Suporte 24h","Fibra \xD3ptica"],category:"internet",isHighlighted:!1},{name:"Intermedi\xE1rio",speed:"500 MEGA",price:"99,90",features:["Wi-Fi Gr\xE1tis","Instala\xE7\xE3o Gr\xE1tis","Suporte 24h","Fibra \xD3ptica"],category:"internet",isHighlighted:!0},{name:"Avan\xE7ado",speed:"600 MEGA",price:"109,90",features:["Wi-Fi Gr\xE1tis","Instala\xE7\xE3o Gr\xE1tis","Suporte 24h","Fibra \xD3ptica"],category:"internet",isHighlighted:!1},{name:"Ultra",speed:"700 MEGA",price:"119,90",features:["Wi-Fi Gr\xE1tis","Instala\xE7\xE3o Gr\xE1tis","Suporte 24h","Fibra \xD3ptica"],category:"internet",isHighlighted:!1},{name:"Gamer",speed:"800 MEGA",price:"129,90",features:["Wi-Fi Gr\xE1tis","Instala\xE7\xE3o Gr\xE1tis","Suporte 24h","Fibra \xD3ptica"],category:"internet",isHighlighted:!1},{name:"Premium",speed:"900 MEGA",price:"139,90",features:["Wi-Fi Gr\xE1tis","Instala\xE7\xE3o Gr\xE1tis","Suporte 24h","Fibra \xD3ptica"],category:"internet",isHighlighted:!1},{name:"Canais Light",speed:"100+ Canais",price:"17,90",features:["Canais abertos entre outros","Qualidade HD","Suporte para TV, iOS, Android e Web","Lista de canais"],category:"tv",isHighlighted:!1},{name:"Canais Plus",speed:"150+ Canais",price:"39,90",features:["Canais abertos entre outros","Qualidade HD","Suporte para TV, iOS, Android e Web","Lista de canais"],category:"tv",isHighlighted:!1},{name:"Canais Ultra",speed:"200+ Canais",price:"53,90",features:["Canais abertos entre outros","Qualidade HD","Suporte para TV, iOS, Android e Web","Lista de canais"],category:"tv",isHighlighted:!0},{name:"Canais Ultra 1P + HBO",speed:"200+ Canais + HBO",price:"70,90",features:["Canais abertos entre outros","Qualidade HD","Suporte para TV, iOS, Android e Web","Lista de canais"],category:"tv",isHighlighted:!1},{name:"C\xE2mera de Seguran\xE7a",speed:"C\xE2mera",price:"25,00",features:["Acesse de onde estiver","Aplicativo para Android e iOS","Vis\xE3o Noturna","C\xE2mera Full HD"],category:"adicionais",isHighlighted:!1},{name:"Roteador Extra",speed:"WIFI 6",price:"25,00",features:["Maior Alcance","Tecnologia Mesh","F\xE1cil Configura\xE7\xE3o","Gigabit"],category:"adicionais",isHighlighted:!1},{name:"TV Box",speed:"Android TV",price:"25,00",features:["Transforma sua TV","Acesso a Apps","Resolu\xE7\xE3o Full HD","Controle Remoto"],category:"adicionais",isHighlighted:!1}])}},M=new _;var m=require("zod"),pe={validation:m.z.object({message:m.z.string(),field:m.z.string().optional()}),notFound:m.z.object({message:m.z.string()}),internal:m.z.object({message:m.z.string()})},A={plans:{list:{method:"GET",path:"/api/plans",responses:{200:m.z.array(m.z.custom())}},get:{method:"GET",path:"/api/plans/:id",responses:{200:m.z.custom(),404:pe.notFound}}}};async function j(e,n){return n.get(A.plans.list.path,async(t,i)=>{let r=await M.getPlans();i.json(r)}),n.get(A.plans.get.path,async(t,i)=>{let r=await M.getPlan(Number(t.params.id));if(!r)return i.status(404).json({message:"Plan not found"});i.json(r)}),e}var H=S(require("express"),1),q=S(require("fs"),1),E=S(require("path"),1);function B(e){let n=E.default.resolve(__dirname,"public");if(!q.default.existsSync(n))throw new Error(`Could not find the build directory: ${n}, make sure to build the client first`);e.use(H.default.static(n)),e.use("*",(t,i)=>{i.sendFile(E.default.resolve(n,"index.html"))})}var O=require("http"),h=(0,y.default)(),L=(0,O.createServer)(h);h.use(y.default.json({verify:(e,n,t)=>{e.rawBody=t}}));h.use(y.default.urlencoded({extended:!1}));function P(e,n="express"){let t=new Date().toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",second:"2-digit",hour12:!0});console.log(`${t} [${n}] ${e}`)}h.use((e,n,t)=>{let i=Date.now(),r=e.path,s,a=n.json;n.json=function(p,...d){return s=p,a.apply(n,[p,...d])},n.on("finish",()=>{let p=Date.now()-i;if(r.startsWith("/api")){let d=`${e.method} ${r} ${n.statusCode} in ${p}ms`;s&&(d+=` :: ${JSON.stringify(s)}`),P(d)}}),t()});(async()=>{await j(L,h),h.use((n,t,i,r)=>{let s=n.status||n.statusCode||500,a=n.message||"Internal Server Error";i.status(s).json({message:a})}),B(h);let e=parseInt(process.env.PORT||"5000",10);L.listen({port:e,host:"0.0.0.0",reusePort:!0},()=>{P(`serving on port ${e}`)})})();0&&(module.exports={log});
2026-01-09T13:01:47.235108399Z [err]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
2026-01-09T13:01:47.235116987Z [err]  
2026-01-09T13:01:47.235123341Z [err]  Error: DATABASE_URL must be set. Did you forget to provision a database?
2026-01-09T13:01:47.235129301Z [err]      at Object.<anonymous> (/app/dist/index.cjs:1:5913)
2026-01-09T13:01:47.235136711Z [err]      at Module._compile (node:internal/modules/cjs/loader:1521:14)
2026-01-09T13:01:47.235142187Z [err]      at Module._extensions..js (node:internal/modules/cjs/loader:1623:10)
2026-01-09T13:01:47.235148677Z [err]      at Module.load (node:internal/modules/cjs/loader:1266:32)
2026-01-09T13:01:47.235153911Z [err]      at Module._load (node:internal/modules/cjs/loader:1091:12)
2026-01-09T13:01:47.235159259Z [err]      at Function.executeUserEntryPoint [as runMain] (node:internal/modules/run_main:164:12)
2026-01-09T13:01:47.235167920Z [err]      at node:internal/main/run_main_module:28:49
2026-01-09T13:01:47.235175707Z [err]  
2026-01-09T13:01:47.235183404Z [err]  Node.js v20.19.6
2026-01-09T13:01:48.049772487Z [err]  /app/dist/index.cjs:1
2026-01-09T13:01:48.050216048Z [err]  "use strict";var z=Object.create;var I=Object.defineProperty;var Q=Object.getOwnPropertyDescriptor;var k=Object.getOwnPropertyNames;var J=Object.getPrototypeOf,Y=Object.prototype.hasOwnProperty;var G=(e,n)=>{for(var t in n)I(e,t,{get:n[t],enumerable:!0})},D=(e,n,t,i)=>{if(n&&typeof n=="object"||typeof n=="function")for(let r of k(n))!Y.call(e,r)&&r!==t&&I(e,r,{get:()=>n[r],enumerable:!(i=Q(n,r))||i.enumerable});return e};var S=(e,n,t)=>(t=e!=null?z(J(e)):{},D(n||!e||!e.__esModule?I(t,"default",{value:e,enumerable:!0}):t,e)),K=e=>D(I({},"__esModule",{value:!0}),e);var ue={};G(ue,{log:()=>P});module.exports=K(ue);var y=S(require("express"),1);var F=require("drizzle-orm/node-postgres"),X=require("drizzle-orm/node-postgres/migrator"),R=S(require("pg"),1);var T={};G(T,{insertPlanSchema:()=>oe,plans:()=>f});var g=require("drizzle-orm/pg-core");var c=require("drizzle-orm"),u=require("zod"),o={INT8_MIN:-128,INT8_MAX:127,INT8_UNSIGNED_MAX:255,INT16_MIN:-32768,INT16_MAX:32767,INT16_UNSIGNED_MAX:65535,INT24_MIN:-8388608,INT24_MAX:8388607,INT24_UNSIGNED_MAX:16777215,INT32_MIN:-2147483648,INT32_MAX:2147483647,INT32_UNSIGNED_MAX:4294967295,INT48_MIN:-0x800000000000,INT48_MAX:0x7fffffffffff,INT48_UNSIGNED_MAX:0xffffffffffff,INT64_MIN:-9223372036854775808n,INT64_MAX:9223372036854775807n,INT64_UNSIGNED_MAX:18446744073709551615n};function l(e,n){return n.includes(e.columnType)}function Z(e){return"enumValues"in e&&Array.isArray(e.enumValues)&&e.enumValues.length>0}var ee=u.z.union([u.z.string(),u.z.number(),u.z.boolean(),u.z.null()]),te=u.z.union([ee,u.z.record(u.z.any()),u.z.array(u.z.any())]),re=u.z.custom(e=>e instanceof Buffer);function v(e,n){let t=n?.zodInstance??u.z,i=n?.coerce??{},r;return Z(e)&&(r=e.enumValues.length?t.enum(e.enumValues):t.string()),r||(l(e,["PgGeometry","PgPointTuple"])?r=t.tuple([t.number(),t.number()]):l(e,["PgGeometryObject","PgPointObject"])?r=t.object({x:t.number(),y:t.number()}):l(e,["PgHalfVector","PgVector"])?(r=t.array(t.number()),r=e.dimensions?r.length(e.dimensions):r):l(e,["PgLine"])?r=t.tuple([t.number(),t.number(),t.number()]):l(e,["PgLineABC"])?r=t.object({a:t.number(),b:t.number(),c:t.number()}):l(e,["PgArray"])?(r=t.array(v(e.baseColumn,t)),r=e.size?r.length(e.size):r):e.dataType==="array"?r=t.array(t.any()):e.dataType==="number"?r=ne(e,t,i):e.dataType==="bigint"?r=ie(e,t,i):e.dataType==="boolean"?r=i===!0||i.boolean?t.coerce.boolean():t.boolean():e.dataType==="date"?r=i===!0||i.date?t.coerce.date():t.date():e.dataType==="string"?r=se(e,t,i):e.dataType==="json"?r=te:e.dataType==="custom"?r=t.any():e.dataType==="buffer"&&(r=re)),r||(r=t.any()),r}function ne(e,n,t){let i=e.getSQLType().includes("unsigned"),r,s,a=!1;l(e,["MySqlTinyInt","SingleStoreTinyInt"])?(r=i?0:o.INT8_MIN,s=i?o.INT8_UNSIGNED_MAX:o.INT8_MAX,a=!0):l(e,["PgSmallInt","PgSmallSerial","MySqlSmallInt","SingleStoreSmallInt"])?(r=i?0:o.INT16_MIN,s=i?o.INT16_UNSIGNED_MAX:o.INT16_MAX,a=!0):l(e,["PgReal","MySqlFloat","MySqlMediumInt","SingleStoreMediumInt","SingleStoreFloat"])?(r=i?0:o.INT24_MIN,s=i?o.INT24_UNSIGNED_MAX:o.INT24_MAX,a=l(e,["MySqlMediumInt","SingleStoreMediumInt"])):l(e,["PgInteger","PgSerial","MySqlInt","SingleStoreInt"])?(r=i?0:o.INT32_MIN,s=i?o.INT32_UNSIGNED_MAX:o.INT32_MAX,a=!0):l(e,["PgDoublePrecision","MySqlReal","MySqlDouble","SingleStoreReal","SingleStoreDouble","SQLiteReal"])?(r=i?0:o.INT48_MIN,s=i?o.INT48_UNSIGNED_MAX:o.INT48_MAX):l(e,["PgBigInt53","PgBigSerial53","MySqlBigInt53","MySqlSerial","SingleStoreBigInt53","SingleStoreSerial","SQLiteInteger"])?(i=i||l(e,["MySqlSerial","SingleStoreSerial"]),r=i?0:Number.MIN_SAFE_INTEGER,s=Number.MAX_SAFE_INTEGER,a=!0):l(e,["MySqlYear","SingleStoreYear"])?(r=1901,s=2155,a=!0):(r=Number.MIN_SAFE_INTEGER,s=Number.MAX_SAFE_INTEGER);let p=t===!0||t?.number?n.coerce.number():n.number();return p=p.min(r).max(s),a?p.int():p}function ie(e,n,t){let i=e.getSQLType().includes("unsigned"),r=i?0n:o.INT64_MIN,s=i?o.INT64_UNSIGNED_MAX:o.INT64_MAX;return(t===!0||t?.bigint?n.coerce.bigint():n.bigint()).min(r).max(s)}function se(e,n,t){if(l(e,["PgUUID"]))return n.string().uuid();let i,r,s=!1;l(e,["PgVarchar","SQLiteText"])?i=e.length:l(e,["MySqlVarChar","SingleStoreVarChar"])?i=e.length??o.INT16_UNSIGNED_MAX:l(e,["MySqlText","SingleStoreText"])&&(e.textType==="longtext"?i=o.INT32_UNSIGNED_MAX:e.textType==="mediumtext"?i=o.INT24_UNSIGNED_MAX:e.textType==="text"?i=o.INT16_UNSIGNED_MAX:i=o.INT8_UNSIGNED_MAX),l(e,["PgChar","MySqlChar","SingleStoreChar"])&&(i=e.length,s=!0),l(e,["PgBinaryVector"])&&(r=/^[01]+$/,i=e.dimensions);let a=t===!0||t?.string?n.coerce.string():n.string();return a=r?a.regex(r):a,i&&s?a.length(i):i?a.max(i):a}function C(e){return(0,c.isTable)(e)?(0,c.getTableColumns)(e):(0,c.getViewSelectedFields)(e)}function w(e,n,t,i){let r={};for(let[s,a]of Object.entries(e)){if(!(0,c.is)(a,c.Column)&&!(0,c.is)(a,c.SQL)&&!(0,c.is)(a,c.SQL.Aliased)&&typeof a=="object"){let W=(0,c.isTable)(a)||(0,c.isView)(a)?C(a):a;r[s]=w(W,n[s]??{},t,i);continue}let p=n[s];if(p!==void 0&&typeof p!="function"){r[s]=p;continue}let d=(0,c.is)(a,c.Column)?a:void 0,x=d?v(d,i):u.z.any(),$=typeof p=="function"?p(x):x;t.never(d)||(r[s]=$,d&&(t.nullable(d)&&(r[s]=r[s].nullable()),t.optional(d)&&(r[s]=r[s].optional())))}return u.z.object(r)}var ae={never:e=>e?.generated?.type==="always"||e?.generatedIdentity?.type==="always",optional:e=>!e.notNull||e.notNull&&e.hasDefault,nullable:e=>!e.notNull};var U=(e,n)=>{let t=C(e);return w(t,n??{},ae)};var f=(0,g.pgTable)("plans",{id:(0,g.serial)("id").primaryKey(),name:(0,g.text)("name").notNull(),speed:(0,g.text)("speed").notNull(),price:(0,g.text)("price").notNull(),description:(0,g.text)("description"),features:(0,g.jsonb)("features").$type().notNull(),isHighlighted:(0,g.boolean)("is_highlighted").default(!1),category:(0,g.text)("category").default("internet")}),oe=U(f);var b=S(require("path"),1),{Pool:le}=R.default;if(!process.env.DATABASE_URL)throw new Error("DATABASE_URL must be set. Did you forget to provision a database?");var ce=new le({connectionString:process.env.DATABASE_URL,ssl:{rejectUnauthorized:!1}}),N=(0,F.drizzle)(ce,{schema:T});(async()=>{try{if(!process.env.DATABASE_URL){console.warn("DATABASE_URL not set, skipping migrations");return}let e=b.default.resolve(process.cwd(),"migrations"),n=await import("fs");n.existsSync(e)&&n.existsSync(b.default.join(e,"meta","_journal.json"))?(console.log("Running migrations..."),await(0,X.migrate)(N,{migrationsFolder:e}),console.log("Migrations completed.")):console.log("No migration files found or journal missing, skipping auto-migration.")}catch(e){console.error("Migration failed:",e)}})();var V=require("drizzle-orm"),_=class{async getPlans(){return await N.select().from(f)}async getPlan(n){return(await N.select().from(f).where((0,V.eq)(f.id,n)))[0]}async seedPlans(){(await N.select().from(f)).length===0&&await N.insert(f).values([{name:"B\xE1sico",speed:"300 MEGA",price:"79,90",features:["Wi-Fi Gr\xE1tis","Instala\xE7\xE3o Gr\xE1tis","Suporte 24h","Fibra \xD3ptica"],category:"internet",isHighlighted:!1},{name:"Essencial",speed:"400 MEGA",price:"89,90",features:["Wi-Fi Gr\xE1tis","Instala\xE7\xE3o Gr\xE1tis","Suporte 24h","Fibra \xD3ptica"],category:"internet",isHighlighted:!1},{name:"Intermedi\xE1rio",speed:"500 MEGA",price:"99,90",features:["Wi-Fi Gr\xE1tis","Instala\xE7\xE3o Gr\xE1tis","Suporte 24h","Fibra \xD3ptica"],category:"internet",isHighlighted:!0},{name:"Avan\xE7ado",speed:"600 MEGA",price:"109,90",features:["Wi-Fi Gr\xE1tis","Instala\xE7\xE3o Gr\xE1tis","Suporte 24h","Fibra \xD3ptica"],category:"internet",isHighlighted:!1},{name:"Ultra",speed:"700 MEGA",price:"119,90",features:["Wi-Fi Gr\xE1tis","Instala\xE7\xE3o Gr\xE1tis","Suporte 24h","Fibra \xD3ptica"],category:"internet",isHighlighted:!1},{name:"Gamer",speed:"800 MEGA",price:"129,90",features:["Wi-Fi Gr\xE1tis","Instala\xE7\xE3o Gr\xE1tis","Suporte 24h","Fibra \xD3ptica"],category:"internet",isHighlighted:!1},{name:"Premium",speed:"900 MEGA",price:"139,90",features:["Wi-Fi Gr\xE1tis","Instala\xE7\xE3o Gr\xE1tis","Suporte 24h","Fibra \xD3ptica"],category:"internet",isHighlighted:!1},{name:"Canais Light",speed:"100+ Canais",price:"17,90",features:["Canais abertos entre outros","Qualidade HD","Suporte para TV, iOS, Android e Web","Lista de canais"],category:"tv",isHighlighted:!1},{name:"Canais Plus",speed:"150+ Canais",price:"39,90",features:["Canais abertos entre outros","Qualidade HD","Suporte para TV, iOS, Android e Web","Lista de canais"],category:"tv",isHighlighted:!1},{name:"Canais Ultra",speed:"200+ Canais",price:"53,90",features:["Canais abertos entre outros","Qualidade HD","Suporte para TV, iOS, Android e Web","Lista de canais"],category:"tv",isHighlighted:!0},{name:"Canais Ultra 1P + HBO",speed:"200+ Canais + HBO",price:"70,90",features:["Canais abertos entre outros","Qualidade HD","Suporte para TV, iOS, Android e Web","Lista de canais"],category:"tv",isHighlighted:!1},{name:"C\xE2mera de Seguran\xE7a",speed:"C\xE2mera",price:"25,00",features:["Acesse de onde estiver","Aplicativo para Android e iOS","Vis\xE3o Noturna","C\xE2mera Full HD"],category:"adicionais",isHighlighted:!1},{name:"Roteador Extra",speed:"WIFI 6",price:"25,00",features:["Maior Alcance","Tecnologia Mesh","F\xE1cil Configura\xE7\xE3o","Gigabit"],category:"adicionais",isHighlighted:!1},{name:"TV Box",speed:"Android TV",price:"25,00",features:["Transforma sua TV","Acesso a Apps","Resolu\xE7\xE3o Full HD","Controle Remoto"],category:"adicionais",isHighlighted:!1}])}},M=new _;var m=require("zod"),pe={validation:m.z.object({message:m.z.string(),field:m.z.string().optional()}),notFound:m.z.object({message:m.z.string()}),internal:m.z.object({message:m.z.string()})},A={plans:{list:{method:"GET",path:"/api/plans",responses:{200:m.z.array(m.z.custom())}},get:{method:"GET",path:"/api/plans/:id",responses:{200:m.z.custom(),404:pe.notFound}}}};async function j(e,n){return n.get(A.plans.list.path,async(t,i)=>{let r=await M.getPlans();i.json(r)}),n.get(A.plans.get.path,async(t,i)=>{let r=await M.getPlan(Number(t.params.id));if(!r)return i.status(404).json({message:"Plan not found"});i.json(r)}),e}var H=S(require("express"),1),q=S(require("fs"),1),E=S(require("path"),1);function B(e){let n=E.default.resolve(__dirname,"public");if(!q.default.existsSync(n))throw new Error(`Could not find the build directory: ${n}, make sure to build the client first`);e.use(H.default.static(n)),e.use("*",(t,i)=>{i.sendFile(E.default.resolve(n,"index.html"))})}var O=require("http"),h=(0,y.default)(),L=(0,O.createServer)(h);h.use(y.default.json({verify:(e,n,t)=>{e.rawBody=t}}));h.use(y.default.urlencoded({extended:!1}));function P(e,n="express"){let t=new Date().toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",second:"2-digit",hour12:!0});console.log(`${t} [${n}] ${e}`)}h.use((e,n,t)=>{let i=Date.now(),r=e.path,s,a=n.json;n.json=function(p,...d){return s=p,a.apply(n,[p,...d])},n.on("finish",()=>{let p=Date.now()-i;if(r.startsWith("/api")){let d=`${e.method} ${r} ${n.statusCode} in ${p}ms`;s&&(d+=` :: ${JSON.stringify(s)}`),P(d)}}),t()});(async()=>{await j(L,h),h.use((n,t,i,r)=>{let s=n.status||n.statusCode||500,a=n.message||"Internal Server Error";i.status(s).json({message:a})}),B(h);let e=parseInt(process.env.PORT||"5000",10);L.listen({port:e,host:"0.0.0.0",reusePort:!0},()=>{P(`serving on port ${e}`)})})();0&&(module.exports={log});
2026-01-09T13:01:48.051324837Z [err]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
2026-01-09T13:01:48.051336430Z [err]  
2026-01-09T13:01:48.051342867Z [err]  Error: DATABASE_URL must be set. Did you forget to provision a database?
2026-01-09T13:01:48.051348600Z [err]      at Object.<anonymous> (/app/dist/index.cjs:1:5913)
2026-01-09T13:01:48.051353397Z [err]      at Module._compile (node:internal/modules/cjs/loader:1521:14)
2026-01-09T13:01:48.051360565Z [err]      at Module._extensions..js (node:internal/modules/cjs/loader:1623:10)
2026-01-09T13:01:48.051366070Z [err]      at Module.load (node:internal/modules/cjs/loader:1266:32)
2026-01-09T13:01:48.051371055Z [err]      at Module._load (node:internal/modules/cjs/loader:1091:12)
2026-01-09T13:01:48.051376446Z [err]      at Function.executeUserEntryPoint [as runMain] (node:internal/modules/run_main:164:12)
2026-01-09T13:01:48.051381640Z [err]      at node:internal/main/run_main_module:28:49
2026-01-09T13:01:48.051393992Z [err]  
2026-01-09T13:01:48.051399094Z [err]  Node.js v20.19.6
2026-01-09T13:01:48.974112541Z [err]  /app/dist/index.cjs:1
2026-01-09T13:01:48.977259482Z [err]  "use strict";var z=Object.create;var I=Object.defineProperty;var Q=Object.getOwnPropertyDescriptor;var k=Object.getOwnPropertyNames;var J=Object.getPrototypeOf,Y=Object.prototype.hasOwnProperty;var G=(e,n)=>{for(var t in n)I(e,t,{get:n[t],enumerable:!0})},D=(e,n,t,i)=>{if(n&&typeof n=="object"||typeof n=="function")for(let r of k(n))!Y.call(e,r)&&r!==t&&I(e,r,{get:()=>n[r],enumerable:!(i=Q(n,r))||i.enumerable});return e};var S=(e,n,t)=>(t=e!=null?z(J(e)):{},D(n||!e||!e.__esModule?I(t,"default",{value:e,enumerable:!0}):t,e)),K=e=>D(I({},"__esModule",{value:!0}),e);var ue={};G(ue,{log:()=>P});module.exports=K(ue);var y=S(require("express"),1);var F=require("drizzle-orm/node-postgres"),X=require("drizzle-orm/node-postgres/migrator"),R=S(require("pg"),1);var T={};G(T,{insertPlanSchema:()=>oe,plans:()=>f});var g=require("drizzle-orm/pg-core");var c=require("drizzle-orm"),u=require("zod"),o={INT8_MIN:-128,INT8_MAX:127,INT8_UNSIGNED_MAX:255,INT16_MIN:-32768,INT16_MAX:32767,INT16_UNSIGNED_MAX:65535,INT24_MIN:-8388608,INT24_MAX:8388607,INT24_UNSIGNED_MAX:16777215,INT32_MIN:-2147483648,INT32_MAX:2147483647,INT32_UNSIGNED_MAX:4294967295,INT48_MIN:-0x800000000000,INT48_MAX:0x7fffffffffff,INT48_UNSIGNED_MAX:0xffffffffffff,INT64_MIN:-9223372036854775808n,INT64_MAX:9223372036854775807n,INT64_UNSIGNED_MAX:18446744073709551615n};function l(e,n){return n.includes(e.columnType)}function Z(e){return"enumValues"in e&&Array.isArray(e.enumValues)&&e.enumValues.length>0}var ee=u.z.union([u.z.string(),u.z.number(),u.z.boolean(),u.z.null()]),te=u.z.union([ee,u.z.record(u.z.any()),u.z.array(u.z.any())]),re=u.z.custom(e=>e instanceof Buffer);function v(e,n){let t=n?.zodInstance??u.z,i=n?.coerce??{},r;return Z(e)&&(r=e.enumValues.length?t.enum(e.enumValues):t.string()),r||(l(e,["PgGeometry","PgPointTuple"])?r=t.tuple([t.number(),t.number()]):l(e,["PgGeometryObject","PgPointObject"])?r=t.object({x:t.number(),y:t.number()}):l(e,["PgHalfVector","PgVector"])?(r=t.array(t.number()),r=e.dimensions?r.length(e.dimensions):r):l(e,["PgLine"])?r=t.tuple([t.number(),t.number(),t.number()]):l(e,["PgLineABC"])?r=t.object({a:t.number(),b:t.number(),c:t.number()}):l(e,["PgArray"])?(r=t.array(v(e.baseColumn,t)),r=e.size?r.length(e.size):r):e.dataType==="array"?r=t.array(t.any()):e.dataType==="number"?r=ne(e,t,i):e.dataType==="bigint"?r=ie(e,t,i):e.dataType==="boolean"?r=i===!0||i.boolean?t.coerce.boolean():t.boolean():e.dataType==="date"?r=i===!0||i.date?t.coerce.date():t.date():e.dataType==="string"?r=se(e,t,i):e.dataType==="json"?r=te:e.dataType==="custom"?r=t.any():e.dataType==="buffer"&&(r=re)),r||(r=t.any()),r}function ne(e,n,t){let i=e.getSQLType().includes("unsigned"),r,s,a=!1;l(e,["MySqlTinyInt","SingleStoreTinyInt"])?(r=i?0:o.INT8_MIN,s=i?o.INT8_UNSIGNED_MAX:o.INT8_MAX,a=!0):l(e,["PgSmallInt","PgSmallSerial","MySqlSmallInt","SingleStoreSmallInt"])?(r=i?0:o.INT16_MIN,s=i?o.INT16_UNSIGNED_MAX:o.INT16_MAX,a=!0):l(e,["PgReal","MySqlFloat","MySqlMediumInt","SingleStoreMediumInt","SingleStoreFloat"])?(r=i?0:o.INT24_MIN,s=i?o.INT24_UNSIGNED_MAX:o.INT24_MAX,a=l(e,["MySqlMediumInt","SingleStoreMediumInt"])):l(e,["PgInteger","PgSerial","MySqlInt","SingleStoreInt"])?(r=i?0:o.INT32_MIN,s=i?o.INT32_UNSIGNED_MAX:o.INT32_MAX,a=!0):l(e,["PgDoublePrecision","MySqlReal","MySqlDouble","SingleStoreReal","SingleStoreDouble","SQLiteReal"])?(r=i?0:o.INT48_MIN,s=i?o.INT48_UNSIGNED_MAX:o.INT48_MAX):l(e,["PgBigInt53","PgBigSerial53","MySqlBigInt53","MySqlSerial","SingleStoreBigInt53","SingleStoreSerial","SQLiteInteger"])?(i=i||l(e,["MySqlSerial","SingleStoreSerial"]),r=i?0:Number.MIN_SAFE_INTEGER,s=Number.MAX_SAFE_INTEGER,a=!0):l(e,["MySqlYear","SingleStoreYear"])?(r=1901,s=2155,a=!0):(r=Number.MIN_SAFE_INTEGER,s=Number.MAX_SAFE_INTEGER);let p=t===!0||t?.number?n.coerce.number():n.number();return p=p.min(r).max(s),a?p.int():p}function ie(e,n,t){let i=e.getSQLType().includes("unsigned"),r=i?0n:o.INT64_MIN,s=i?o.INT64_UNSIGNED_MAX:o.INT64_MAX;return(t===!0||t?.bigint?n.coerce.bigint():n.bigint()).min(r).max(s)}function se(e,n,t){if(l(e,["PgUUID"]))return n.string().uuid();let i,r,s=!1;l(e,["PgVarchar","SQLiteText"])?i=e.length:l(e,["MySqlVarChar","SingleStoreVarChar"])?i=e.length??o.INT16_UNSIGNED_MAX:l(e,["MySqlText","SingleStoreText"])&&(e.textType==="longtext"?i=o.INT32_UNSIGNED_MAX:e.textType==="mediumtext"?i=o.INT24_UNSIGNED_MAX:e.textType==="text"?i=o.INT16_UNSIGNED_MAX:i=o.INT8_UNSIGNED_MAX),l(e,["PgChar","MySqlChar","SingleStoreChar"])&&(i=e.length,s=!0),l(e,["PgBinaryVector"])&&(r=/^[01]+$/,i=e.dimensions);let a=t===!0||t?.string?n.coerce.string():n.string();return a=r?a.regex(r):a,i&&s?a.length(i):i?a.max(i):a}function C(e){return(0,c.isTable)(e)?(0,c.getTableColumns)(e):(0,c.getViewSelectedFields)(e)}function w(e,n,t,i){let r={};for(let[s,a]of Object.entries(e)){if(!(0,c.is)(a,c.Column)&&!(0,c.is)(a,c.SQL)&&!(0,c.is)(a,c.SQL.Aliased)&&typeof a=="object"){let W=(0,c.isTable)(a)||(0,c.isView)(a)?C(a):a;r[s]=w(W,n[s]??{},t,i);continue}let p=n[s];if(p!==void 0&&typeof p!="function"){r[s]=p;continue}let d=(0,c.is)(a,c.Column)?a:void 0,x=d?v(d,i):u.z.any(),$=typeof p=="function"?p(x):x;t.never(d)||(r[s]=$,d&&(t.nullable(d)&&(r[s]=r[s].nullable()),t.optional(d)&&(r[s]=r[s].optional())))}return u.z.object(r)}var ae={never:e=>e?.generated?.type==="always"||e?.generatedIdentity?.type==="always",optional:e=>!e.notNull||e.notNull&&e.hasDefault,nullable:e=>!e.notNull};var U=(e,n)=>{let t=C(e);return w(t,n??{},ae)};var f=(0,g.pgTable)("plans",{id:(0,g.serial)("id").primaryKey(),name:(0,g.text)("name").notNull(),speed:(0,g.text)("speed").notNull(),price:(0,g.text)("price").notNull(),description:(0,g.text)("description"),features:(0,g.jsonb)("features").$type().notNull(),isHighlighted:(0,g.boolean)("is_highlighted").default(!1),category:(0,g.text)("category").default("internet")}),oe=U(f);var b=S(require("path"),1),{Pool:le}=R.default;if(!process.env.DATABASE_URL)throw new Error("DATABASE_URL must be set. Did you forget to provision a database?");var ce=new le({connectionString:process.env.DATABASE_URL,ssl:{rejectUnauthorized:!1}}),N=(0,F.drizzle)(ce,{schema:T});(async()=>{try{if(!process.env.DATABASE_URL){console.warn("DATABASE_URL not set, skipping migrations");return}let e=b.default.resolve(process.cwd(),"migrations"),n=await import("fs");n.existsSync(e)&&n.existsSync(b.default.join(e,"meta","_journal.json"))?(console.log("Running migrations..."),await(0,X.migrate)(N,{migrationsFolder:e}),console.log("Migrations completed.")):console.log("No migration files found or journal missing, skipping auto-migration.")}catch(e){console.error("Migration failed:",e)}})();var V=require("drizzle-orm"),_=class{async getPlans(){return await N.select().from(f)}async getPlan(n){return(await N.select().from(f).where((0,V.eq)(f.id,n)))[0]}async seedPlans(){(await N.select().from(f)).length===0&&await N.insert(f).values([{name:"B\xE1sico",speed:"300 MEGA",price:"79,90",features:["Wi-Fi Gr\xE1tis","Instala\xE7\xE3o Gr\xE1tis","Suporte 24h","Fibra \xD3ptica"],category:"internet",isHighlighted:!1},{name:"Essencial",speed:"400 MEGA",price:"89,90",features:["Wi-Fi Gr\xE1tis","Instala\xE7\xE3o Gr\xE1tis","Suporte 24h","Fibra \xD3ptica"],category:"internet",isHighlighted:!1},{name:"Intermedi\xE1rio",speed:"500 MEGA",price:"99,90",features:["Wi-Fi Gr\xE1tis","Instala\xE7\xE3o Gr\xE1tis","Suporte 24h","Fibra \xD3ptica"],category:"internet",isHighlighted:!0},{name:"Avan\xE7ado",speed:"600 MEGA",price:"109,90",features:["Wi-Fi Gr\xE1tis","Instala\xE7\xE3o Gr\xE1tis","Suporte 24h","Fibra \xD3ptica"],category:"internet",isHighlighted:!1},{name:"Ultra",speed:"700 MEGA",price:"119,90",features:["Wi-Fi Gr\xE1tis","Instala\xE7\xE3o Gr\xE1tis","Suporte 24h","Fibra \xD3ptica"],category:"internet",isHighlighted:!1},{name:"Gamer",speed:"800 MEGA",price:"129,90",features:["Wi-Fi Gr\xE1tis","Instala\xE7\xE3o Gr\xE1tis","Suporte 24h","Fibra \xD3ptica"],category:"internet",isHighlighted:!1},{name:"Premium",speed:"900 MEGA",price:"139,90",features:["Wi-Fi Gr\xE1tis","Instala\xE7\xE3o Gr\xE1tis","Suporte 24h","Fibra \xD3ptica"],category:"internet",isHighlighted:!1},{name:"Canais Light",speed:"100+ Canais",price:"17,90",features:["Canais abertos entre outros","Qualidade HD","Suporte para TV, iOS, Android e Web","Lista de canais"],category:"tv",isHighlighted:!1},{name:"Canais Plus",speed:"150+ Canais",price:"39,90",features:["Canais abertos entre outros","Qualidade HD","Suporte para TV, iOS, Android e Web","Lista de canais"],category:"tv",isHighlighted:!1},{name:"Canais Ultra",speed:"200+ Canais",price:"53,90",features:["Canais abertos entre outros","Qualidade HD","Suporte para TV, iOS, Android e Web","Lista de canais"],category:"tv",isHighlighted:!0},{name:"Canais Ultra 1P + HBO",speed:"200+ Canais + HBO",price:"70,90",features:["Canais abertos entre outros","Qualidade HD","Suporte para TV, iOS, Android e Web","Lista de canais"],category:"tv",isHighlighted:!1},{name:"C\xE2mera de Seguran\xE7a",speed:"C\xE2mera",price:"25,00",features:["Acesse de onde estiver","Aplicativo para Android e iOS","Vis\xE3o Noturna","C\xE2mera Full HD"],category:"adicionais",isHighlighted:!1},{name:"Roteador Extra",speed:"WIFI 6",price:"25,00",features:["Maior Alcance","Tecnologia Mesh","F\xE1cil Configura\xE7\xE3o","Gigabit"],category:"adicionais",isHighlighted:!1},{name:"TV Box",speed:"Android TV",price:"25,00",features:["Transforma sua TV","Acesso a Apps","Resolu\xE7\xE3o Full HD","Controle Remoto"],category:"adicionais",isHighlighted:!1}])}},M=new _;var m=require("zod"),pe={validation:m.z.object({message:m.z.string(),field:m.z.string().optional()}),notFound:m.z.object({message:m.z.string()}),internal:m.z.object({message:m.z.string()})},A={plans:{list:{method:"GET",path:"/api/plans",responses:{200:m.z.array(m.z.custom())}},get:{method:"GET",path:"/api/plans/:id",responses:{200:m.z.custom(),404:pe.notFound}}}};async function j(e,n){return n.get(A.plans.list.path,async(t,i)=>{let r=await M.getPlans();i.json(r)}),n.get(A.plans.get.path,async(t,i)=>{let r=await M.getPlan(Number(t.params.id));if(!r)return i.status(404).json({message:"Plan not found"});i.json(r)}),e}var H=S(require("express"),1),q=S(require("fs"),1),E=S(require("path"),1);function B(e){let n=E.default.resolve(__dirname,"public");if(!q.default.existsSync(n))throw new Error(`Could not find the build directory: ${n}, make sure to build the client first`);e.use(H.default.static(n)),e.use("*",(t,i)=>{i.sendFile(E.default.resolve(n,"index.html"))})}var O=require("http"),h=(0,y.default)(),L=(0,O.createServer)(h);h.use(y.default.json({verify:(e,n,t)=>{e.rawBody=t}}));h.use(y.default.urlencoded({extended:!1}));function P(e,n="express"){let t=new Date().toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",second:"2-digit",hour12:!0});console.log(`${t} [${n}] ${e}`)}h.use((e,n,t)=>{let i=Date.now(),r=e.path,s,a=n.json;n.json=function(p,...d){return s=p,a.apply(n,[p,...d])},n.on("finish",()=>{let p=Date.now()-i;if(r.startsWith("/api")){let d=`${e.method} ${r} ${n.statusCode} in ${p}ms`;s&&(d+=` :: ${JSON.stringify(s)}`),P(d)}}),t()});(async()=>{await j(L,h),h.use((n,t,i,r)=>{let s=n.status||n.statusCode||500,a=n.message||"Internal Server Error";i.status(s).json({message:a})}),B(h);let e=parseInt(process.env.PORT||"5000",10);L.listen({port:e,host:"0.0.0.0",reusePort:!0},()=>{P(`serving on port ${e}`)})})();0&&(module.exports={log});
2026-01-09T13:01:48.977265434Z [err]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
2026-01-09T13:01:48.977271375Z [err]  
2026-01-09T13:01:48.977278968Z [err]  Error: DATABASE_URL must be set. Did you forget to provision a database?
2026-01-09T13:01:48.977286722Z [err]      at Object.<anonymous> (/app/dist/index.cjs:1:5913)
2026-01-09T13:01:48.977295372Z [err]      at Module._compile (node:internal/modules/cjs/loader:1521:14)
2026-01-09T13:01:48.977304238Z [err]      at Module._extensions..js (node:internal/modules/cjs/loader:1623:10)
2026-01-09T13:01:48.977311958Z [err]      at Module.load (node:internal/modules/cjs/loader:1266:32)
2026-01-09T13:01:48.977319432Z [err]      at Module._load (node:internal/modules/cjs/loader:1091:12)
2026-01-09T13:01:48.977327526Z [err]      at Function.executeUserEntryPoint [as runMain] (node:internal/modules/run_main:164:12)
2026-01-09T13:01:48.977335912Z [err]      at node:internal/main/run_main_module:28:49
2026-01-09T13:01:48.977344799Z [err]  
2026-01-09T13:01:48.977352587Z [err]  Node.js v20.19.6
2026-01-09T13:01:49.661181985Z [err]  /app/dist/index.cjs:1
2026-01-09T13:01:49.661276053Z [err]  "use strict";var z=Object.create;var I=Object.defineProperty;var Q=Object.getOwnPropertyDescriptor;var k=Object.getOwnPropertyNames;var J=Object.getPrototypeOf,Y=Object.prototype.hasOwnProperty;var G=(e,n)=>{for(var t in n)I(e,t,{get:n[t],enumerable:!0})},D=(e,n,t,i)=>{if(n&&typeof n=="object"||typeof n=="function")for(let r of k(n))!Y.call(e,r)&&r!==t&&I(e,r,{get:()=>n[r],enumerable:!(i=Q(n,r))||i.enumerable});return e};var S=(e,n,t)=>(t=e!=null?z(J(e)):{},D(n||!e||!e.__esModule?I(t,"default",{value:e,enumerable:!0}):t,e)),K=e=>D(I({},"__esModule",{value:!0}),e);var ue={};G(ue,{log:()=>P});module.exports=K(ue);var y=S(require("express"),1);var F=require("drizzle-orm/node-postgres"),X=require("drizzle-orm/node-postgres/migrator"),R=S(require("pg"),1);var T={};G(T,{insertPlanSchema:()=>oe,plans:()=>f});var g=require("drizzle-orm/pg-core");var c=require("drizzle-orm"),u=require("zod"),o={INT8_MIN:-128,INT8_MAX:127,INT8_UNSIGNED_MAX:255,INT16_MIN:-32768,INT16_MAX:32767,INT16_UNSIGNED_MAX:65535,INT24_MIN:-8388608,INT24_MAX:8388607,INT24_UNSIGNED_MAX:16777215,INT32_MIN:-2147483648,INT32_MAX:2147483647,INT32_UNSIGNED_MAX:4294967295,INT48_MIN:-0x800000000000,INT48_MAX:0x7fffffffffff,INT48_UNSIGNED_MAX:0xffffffffffff,INT64_MIN:-9223372036854775808n,INT64_MAX:9223372036854775807n,INT64_UNSIGNED_MAX:18446744073709551615n};function l(e,n){return n.includes(e.columnType)}function Z(e){return"enumValues"in e&&Array.isArray(e.enumValues)&&e.enumValues.length>0}var ee=u.z.union([u.z.string(),u.z.number(),u.z.boolean(),u.z.null()]),te=u.z.union([ee,u.z.record(u.z.any()),u.z.array(u.z.any())]),re=u.z.custom(e=>e instanceof Buffer);function v(e,n){let t=n?.zodInstance??u.z,i=n?.coerce??{},r;return Z(e)&&(r=e.enumValues.length?t.enum(e.enumValues):t.string()),r||(l(e,["PgGeometry","PgPointTuple"])?r=t.tuple([t.number(),t.number()]):l(e,["PgGeometryObject","PgPointObject"])?r=t.object({x:t.number(),y:t.number()}):l(e,["PgHalfVector","PgVector"])?(r=t.array(t.number()),r=e.dimensions?r.length(e.dimensions):r):l(e,["PgLine"])?r=t.tuple([t.number(),t.number(),t.number()]):l(e,["PgLineABC"])?r=t.object({a:t.number(),b:t.number(),c:t.number()}):l(e,["PgArray"])?(r=t.array(v(e.baseColumn,t)),r=e.size?r.length(e.size):r):e.dataType==="array"?r=t.array(t.any()):e.dataType==="number"?r=ne(e,t,i):e.dataType==="bigint"?r=ie(e,t,i):e.dataType==="boolean"?r=i===!0||i.boolean?t.coerce.boolean():t.boolean():e.dataType==="date"?r=i===!0||i.date?t.coerce.date():t.date():e.dataType==="string"?r=se(e,t,i):e.dataType==="json"?r=te:e.dataType==="custom"?r=t.any():e.dataType==="buffer"&&(r=re)),r||(r=t.any()),r}function ne(e,n,t){let i=e.getSQLType().includes("unsigned"),r,s,a=!1;l(e,["MySqlTinyInt","SingleStoreTinyInt"])?(r=i?0:o.INT8_MIN,s=i?o.INT8_UNSIGNED_MAX:o.INT8_MAX,a=!0):l(e,["PgSmallInt","PgSmallSerial","MySqlSmallInt","SingleStoreSmallInt"])?(r=i?0:o.INT16_MIN,s=i?o.INT16_UNSIGNED_MAX:o.INT16_MAX,a=!0):l(e,["PgReal","MySqlFloat","MySqlMediumInt","SingleStoreMediumInt","SingleStoreFloat"])?(r=i?0:o.INT24_MIN,s=i?o.INT24_UNSIGNED_MAX:o.INT24_MAX,a=l(e,["MySqlMediumInt","SingleStoreMediumInt"])):l(e,["PgInteger","PgSerial","MySqlInt","SingleStoreInt"])?(r=i?0:o.INT32_MIN,s=i?o.INT32_UNSIGNED_MAX:o.INT32_MAX,a=!0):l(e,["PgDoublePrecision","MySqlReal","MySqlDouble","SingleStoreReal","SingleStoreDouble","SQLiteReal"])?(r=i?0:o.INT48_MIN,s=i?o.INT48_UNSIGNED_MAX:o.INT48_MAX):l(e,["PgBigInt53","PgBigSerial53","MySqlBigInt53","MySqlSerial","SingleStoreBigInt53","SingleStoreSerial","SQLiteInteger"])?(i=i||l(e,["MySqlSerial","SingleStoreSerial"]),r=i?0:Number.MIN_SAFE_INTEGER,s=Number.MAX_SAFE_INTEGER,a=!0):l(e,["MySqlYear","SingleStoreYear"])?(r=1901,s=2155,a=!0):(r=Number.MIN_SAFE_INTEGER,s=Number.MAX_SAFE_INTEGER);let p=t===!0||t?.number?n.coerce.number():n.number();return p=p.min(r).max(s),a?p.int():p}function ie(e,n,t){let i=e.getSQLType().includes("unsigned"),r=i?0n:o.INT64_MIN,s=i?o.INT64_UNSIGNED_MAX:o.INT64_MAX;return(t===!0||t?.bigint?n.coerce.bigint():n.bigint()).min(r).max(s)}function se(e,n,t){if(l(e,["PgUUID"]))return n.string().uuid();let i,r,s=!1;l(e,["PgVarchar","SQLiteText"])?i=e.length:l(e,["MySqlVarChar","SingleStoreVarChar"])?i=e.length??o.INT16_UNSIGNED_MAX:l(e,["MySqlText","SingleStoreText"])&&(e.textType==="longtext"?i=o.INT32_UNSIGNED_MAX:e.textType==="mediumtext"?i=o.INT24_UNSIGNED_MAX:e.textType==="text"?i=o.INT16_UNSIGNED_MAX:i=o.INT8_UNSIGNED_MAX),l(e,["PgChar","MySqlChar","SingleStoreChar"])&&(i=e.length,s=!0),l(e,["PgBinaryVector"])&&(r=/^[01]+$/,i=e.dimensions);let a=t===!0||t?.string?n.coerce.string():n.string();return a=r?a.regex(r):a,i&&s?a.length(i):i?a.max(i):a}function C(e){return(0,c.isTable)(e)?(0,c.getTableColumns)(e):(0,c.getViewSelectedFields)(e)}function w(e,n,t,i){let r={};for(let[s,a]of Object.entries(e)){if(!(0,c.is)(a,c.Column)&&!(0,c.is)(a,c.SQL)&&!(0,c.is)(a,c.SQL.Aliased)&&typeof a=="object"){let W=(0,c.isTable)(a)||(0,c.isView)(a)?C(a):a;r[s]=w(W,n[s]??{},t,i);continue}let p=n[s];if(p!==void 0&&typeof p!="function"){r[s]=p;continue}let d=(0,c.is)(a,c.Column)?a:void 0,x=d?v(d,i):u.z.any(),$=typeof p=="function"?p(x):x;t.never(d)||(r[s]=$,d&&(t.nullable(d)&&(r[s]=r[s].nullable()),t.optional(d)&&(r[s]=r[s].optional())))}return u.z.object(r)}var ae={never:e=>e?.generated?.type==="always"||e?.generatedIdentity?.type==="always",optional:e=>!e.notNull||e.notNull&&e.hasDefault,nullable:e=>!e.notNull};var U=(e,n)=>{let t=C(e);return w(t,n??{},ae)};var f=(0,g.pgTable)("plans",{id:(0,g.serial)("id").primaryKey(),name:(0,g.text)("name").notNull(),speed:(0,g.text)("speed").notNull(),price:(0,g.text)("price").notNull(),description:(0,g.text)("description"),features:(0,g.jsonb)("features").$type().notNull(),isHighlighted:(0,g.boolean)("is_highlighted").default(!1),category:(0,g.text)("category").default("internet")}),oe=U(f);var b=S(require("path"),1),{Pool:le}=R.default;if(!process.env.DATABASE_URL)throw new Error("DATABASE_URL must be set. Did you forget to provision a database?");var ce=new le({connectionString:process.env.DATABASE_URL,ssl:{rejectUnauthorized:!1}}),N=(0,F.drizzle)(ce,{schema:T});(async()=>{try{if(!process.env.DATABASE_URL){console.warn("DATABASE_URL not set, skipping migrations");return}let e=b.default.resolve(process.cwd(),"migrations"),n=await import("fs");n.existsSync(e)&&n.existsSync(b.default.join(e,"meta","_journal.json"))?(console.log("Running migrations..."),await(0,X.migrate)(N,{migrationsFolder:e}),console.log("Migrations completed.")):console.log("No migration files found or journal missing, skipping auto-migration.")}catch(e){console.error("Migration failed:",e)}})();var V=require("drizzle-orm"),_=class{async getPlans(){return await N.select().from(f)}async getPlan(n){return(await N.select().from(f).where((0,V.eq)(f.id,n)))[0]}async seedPlans(){(await N.select().from(f)).length===0&&await N.insert(f).values([{name:"B\xE1sico",speed:"300 MEGA",price:"79,90",features:["Wi-Fi Gr\xE1tis","Instala\xE7\xE3o Gr\xE1tis","Suporte 24h","Fibra \xD3ptica"],category:"internet",isHighlighted:!1},{name:"Essencial",speed:"400 MEGA",price:"89,90",features:["Wi-Fi Gr\xE1tis","Instala\xE7\xE3o Gr\xE1tis","Suporte 24h","Fibra \xD3ptica"],category:"internet",isHighlighted:!1},{name:"Intermedi\xE1rio",speed:"500 MEGA",price:"99,90",features:["Wi-Fi Gr\xE1tis","Instala\xE7\xE3o Gr\xE1tis","Suporte 24h","Fibra \xD3ptica"],category:"internet",isHighlighted:!0},{name:"Avan\xE7ado",speed:"600 MEGA",price:"109,90",features:["Wi-Fi Gr\xE1tis","Instala\xE7\xE3o Gr\xE1tis","Suporte 24h","Fibra \xD3ptica"],category:"internet",isHighlighted:!1},{name:"Ultra",speed:"700 MEGA",price:"119,90",features:["Wi-Fi Gr\xE1tis","Instala\xE7\xE3o Gr\xE1tis","Suporte 24h","Fibra \xD3ptica"],category:"internet",isHighlighted:!1},{name:"Gamer",speed:"800 MEGA",price:"129,90",features:["Wi-Fi Gr\xE1tis","Instala\xE7\xE3o Gr\xE1tis","Suporte 24h","Fibra \xD3ptica"],category:"internet",isHighlighted:!1},{name:"Premium",speed:"900 MEGA",price:"139,90",features:["Wi-Fi Gr\xE1tis","Instala\xE7\xE3o Gr\xE1tis","Suporte 24h","Fibra \xD3ptica"],category:"internet",isHighlighted:!1},{name:"Canais Light",speed:"100+ Canais",price:"17,90",features:["Canais abertos entre outros","Qualidade HD","Suporte para TV, iOS, Android e Web","Lista de canais"],category:"tv",isHighlighted:!1},{name:"Canais Plus",speed:"150+ Canais",price:"39,90",features:["Canais abertos entre outros","Qualidade HD","Suporte para TV, iOS, Android e Web","Lista de canais"],category:"tv",isHighlighted:!1},{name:"Canais Ultra",speed:"200+ Canais",price:"53,90",features:["Canais abertos entre outros","Qualidade HD","Suporte para TV, iOS, Android e Web","Lista de canais"],category:"tv",isHighlighted:!0},{name:"Canais Ultra 1P + HBO",speed:"200+ Canais + HBO",price:"70,90",features:["Canais abertos entre outros","Qualidade HD","Suporte para TV, iOS, Android e Web","Lista de canais"],category:"tv",isHighlighted:!1},{name:"C\xE2mera de Seguran\xE7a",speed:"C\xE2mera",price:"25,00",features:["Acesse de onde estiver","Aplicativo para Android e iOS","Vis\xE3o Noturna","C\xE2mera Full HD"],category:"adicionais",isHighlighted:!1},{name:"Roteador Extra",speed:"WIFI 6",price:"25,00",features:["Maior Alcance","Tecnologia Mesh","F\xE1cil Configura\xE7\xE3o","Gigabit"],category:"adicionais",isHighlighted:!1},{name:"TV Box",speed:"Android TV",price:"25,00",features:["Transforma sua TV","Acesso a Apps","Resolu\xE7\xE3o Full HD","Controle Remoto"],category:"adicionais",isHighlighted:!1}])}},M=new _;var m=require("zod"),pe={validation:m.z.object({message:m.z.string(),field:m.z.string().optional()}),notFound:m.z.object({message:m.z.string()}),internal:m.z.object({message:m.z.string()})},A={plans:{list:{method:"GET",path:"/api/plans",responses:{200:m.z.array(m.z.custom())}},get:{method:"GET",path:"/api/plans/:id",responses:{200:m.z.custom(),404:pe.notFound}}}};async function j(e,n){return n.get(A.plans.list.path,async(t,i)=>{let r=await M.getPlans();i.json(r)}),n.get(A.plans.get.path,async(t,i)=>{let r=await M.getPlan(Number(t.params.id));if(!r)return i.status(404).json({message:"Plan not found"});i.json(r)}),e}var H=S(require("express"),1),q=S(require("fs"),1),E=S(require("path"),1);function B(e){let n=E.default.resolve(__dirname,"public");if(!q.default.existsSync(n))throw new Error(`Could not find the build directory: ${n}, make sure to build the client first`);e.use(H.default.static(n)),e.use("*",(t,i)=>{i.sendFile(E.default.resolve(n,"index.html"))})}var O=require("http"),h=(0,y.default)(),L=(0,O.createServer)(h);h.use(y.default.json({verify:(e,n,t)=>{e.rawBody=t}}));h.use(y.default.urlencoded({extended:!1}));function P(e,n="express"){let t=new Date().toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",second:"2-digit",hour12:!0});console.log(`${t} [${n}] ${e}`)}h.use((e,n,t)=>{let i=Date.now(),r=e.path,s,a=n.json;n.json=function(p,...d){return s=p,a.apply(n,[p,...d])},n.on("finish",()=>{let p=Date.now()-i;if(r.startsWith("/api")){let d=`${e.method} ${r} ${n.statusCode} in ${p}ms`;s&&(d+=` :: ${JSON.stringify(s)}`),P(d)}}),t()});(async()=>{await j(L,h),h.use((n,t,i,r)=>{let s=n.status||n.statusCode||500,a=n.message||"Internal Server Error";i.status(s).json({message:a})}),B(h);let e=parseInt(process.env.PORT||"5000",10);L.listen({port:e,host:"0.0.0.0",reusePort:!0},()=>{P(`serving on port ${e}`)})})();0&&(module.exports={log});
2026-01-09T13:01:49.662601248Z [err]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
2026-01-09T13:01:49.662610254Z [err]  
2026-01-09T13:01:49.662616066Z [err]  Error: DATABASE_URL must be set. Did you forget to provision a database?
2026-01-09T13:01:49.662621439Z [err]      at Object.<anonymous> (/app/dist/index.cjs:1:5913)
2026-01-09T13:01:49.662628209Z [err]      at Module._compile (node:internal/modules/cjs/loader:1521:14)
2026-01-09T13:01:49.662646088Z [err]      at Module._extensions..js (node:internal/modules/cjs/loader:1623:10)
2026-01-09T13:01:49.662653315Z [err]      at Module.load (node:internal/modules/cjs/loader:1266:32)
2026-01-09T13:01:49.662660922Z [err]      at Module._load (node:internal/modules/cjs/loader:1091:12)
2026-01-09T13:01:49.662670763Z [err]      at Function.executeUserEntryPoint [as runMain] (node:internal/modules/run_main:164:12)
2026-01-09T13:01:49.662678304Z [err]      at node:internal/main/run_main_module:28:49
2026-01-09T13:01:49.662689186Z [err]  
2026-01-09T13:01:49.662696581Z [err]  Node.js v20.19.6
2026-01-09T13:01:50.547792709Z [err]  /app/dist/index.cjs:1
2026-01-09T13:01:50.551030566Z [err]  "use strict";var z=Object.create;var I=Object.defineProperty;var Q=Object.getOwnPropertyDescriptor;var k=Object.getOwnPropertyNames;var J=Object.getPrototypeOf,Y=Object.prototype.hasOwnProperty;var G=(e,n)=>{for(var t in n)I(e,t,{get:n[t],enumerable:!0})},D=(e,n,t,i)=>{if(n&&typeof n=="object"||typeof n=="function")for(let r of k(n))!Y.call(e,r)&&r!==t&&I(e,r,{get:()=>n[r],enumerable:!(i=Q(n,r))||i.enumerable});return e};var S=(e,n,t)=>(t=e!=null?z(J(e)):{},D(n||!e||!e.__esModule?I(t,"default",{value:e,enumerable:!0}):t,e)),K=e=>D(I({},"__esModule",{value:!0}),e);var ue={};G(ue,{log:()=>P});module.exports=K(ue);var y=S(require("express"),1);var F=require("drizzle-orm/node-postgres"),X=require("drizzle-orm/node-postgres/migrator"),R=S(require("pg"),1);var T={};G(T,{insertPlanSchema:()=>oe,plans:()=>f});var g=require("drizzle-orm/pg-core");var c=require("drizzle-orm"),u=require("zod"),o={INT8_MIN:-128,INT8_MAX:127,INT8_UNSIGNED_MAX:255,INT16_MIN:-32768,INT16_MAX:32767,INT16_UNSIGNED_MAX:65535,INT24_MIN:-8388608,INT24_MAX:8388607,INT24_UNSIGNED_MAX:16777215,INT32_MIN:-2147483648,INT32_MAX:2147483647,INT32_UNSIGNED_MAX:4294967295,INT48_MIN:-0x800000000000,INT48_MAX:0x7fffffffffff,INT48_UNSIGNED_MAX:0xffffffffffff,INT64_MIN:-9223372036854775808n,INT64_MAX:9223372036854775807n,INT64_UNSIGNED_MAX:18446744073709551615n};function l(e,n){return n.includes(e.columnType)}function Z(e){return"enumValues"in e&&Array.isArray(e.enumValues)&&e.enumValues.length>0}var ee=u.z.union([u.z.string(),u.z.number(),u.z.boolean(),u.z.null()]),te=u.z.union([ee,u.z.record(u.z.any()),u.z.array(u.z.any())]),re=u.z.custom(e=>e instanceof Buffer);function v(e,n){let t=n?.zodInstance??u.z,i=n?.coerce??{},r;return Z(e)&&(r=e.enumValues.length?t.enum(e.enumValues):t.string()),r||(l(e,["PgGeometry","PgPointTuple"])?r=t.tuple([t.number(),t.number()]):l(e,["PgGeometryObject","PgPointObject"])?r=t.object({x:t.number(),y:t.number()}):l(e,["PgHalfVector","PgVector"])?(r=t.array(t.number()),r=e.dimensions?r.length(e.dimensions):r):l(e,["PgLine"])?r=t.tuple([t.number(),t.number(),t.number()]):l(e,["PgLineABC"])?r=t.object({a:t.number(),b:t.number(),c:t.number()}):l(e,["PgArray"])?(r=t.array(v(e.baseColumn,t)),r=e.size?r.length(e.size):r):e.dataType==="array"?r=t.array(t.any()):e.dataType==="number"?r=ne(e,t,i):e.dataType==="bigint"?r=ie(e,t,i):e.dataType==="boolean"?r=i===!0||i.boolean?t.coerce.boolean():t.boolean():e.dataType==="date"?r=i===!0||i.date?t.coerce.date():t.date():e.dataType==="string"?r=se(e,t,i):e.dataType==="json"?r=te:e.dataType==="custom"?r=t.any():e.dataType==="buffer"&&(r=re)),r||(r=t.any()),r}function ne(e,n,t){let i=e.getSQLType().includes("unsigned"),r,s,a=!1;l(e,["MySqlTinyInt","SingleStoreTinyInt"])?(r=i?0:o.INT8_MIN,s=i?o.INT8_UNSIGNED_MAX:o.INT8_MAX,a=!0):l(e,["PgSmallInt","PgSmallSerial","MySqlSmallInt","SingleStoreSmallInt"])?(r=i?0:o.INT16_MIN,s=i?o.INT16_UNSIGNED_MAX:o.INT16_MAX,a=!0):l(e,["PgReal","MySqlFloat","MySqlMediumInt","SingleStoreMediumInt","SingleStoreFloat"])?(r=i?0:o.INT24_MIN,s=i?o.INT24_UNSIGNED_MAX:o.INT24_MAX,a=l(e,["MySqlMediumInt","SingleStoreMediumInt"])):l(e,["PgInteger","PgSerial","MySqlInt","SingleStoreInt"])?(r=i?0:o.INT32_MIN,s=i?o.INT32_UNSIGNED_MAX:o.INT32_MAX,a=!0):l(e,["PgDoublePrecision","MySqlReal","MySqlDouble","SingleStoreReal","SingleStoreDouble","SQLiteReal"])?(r=i?0:o.INT48_MIN,s=i?o.INT48_UNSIGNED_MAX:o.INT48_MAX):l(e,["PgBigInt53","PgBigSerial53","MySqlBigInt53","MySqlSerial","SingleStoreBigInt53","SingleStoreSerial","SQLiteInteger"])?(i=i||l(e,["MySqlSerial","SingleStoreSerial"]),r=i?0:Number.MIN_SAFE_INTEGER,s=Number.MAX_SAFE_INTEGER,a=!0):l(e,["MySqlYear","SingleStoreYear"])?(r=1901,s=2155,a=!0):(r=Number.MIN_SAFE_INTEGER,s=Number.MAX_SAFE_INTEGER);let p=t===!0||t?.number?n.coerce.number():n.number();return p=p.min(r).max(s),a?p.int():p}function ie(e,n,t){let i=e.getSQLType().includes("unsigned"),r=i?0n:o.INT64_MIN,s=i?o.INT64_UNSIGNED_MAX:o.INT64_MAX;return(t===!0||t?.bigint?n.coerce.bigint():n.bigint()).min(r).max(s)}function se(e,n,t){if(l(e,["PgUUID"]))return n.string().uuid();let i,r,s=!1;l(e,["PgVarchar","SQLiteText"])?i=e.length:l(e,["MySqlVarChar","SingleStoreVarChar"])?i=e.length??o.INT16_UNSIGNED_MAX:l(e,["MySqlText","SingleStoreText"])&&(e.textType==="longtext"?i=o.INT32_UNSIGNED_MAX:e.textType==="mediumtext"?i=o.INT24_UNSIGNED_MAX:e.textType==="text"?i=o.INT16_UNSIGNED_MAX:i=o.INT8_UNSIGNED_MAX),l(e,["PgChar","MySqlChar","SingleStoreChar"])&&(i=e.length,s=!0),l(e,["PgBinaryVector"])&&(r=/^[01]+$/,i=e.dimensions);let a=t===!0||t?.string?n.coerce.string():n.string();return a=r?a.regex(r):a,i&&s?a.length(i):i?a.max(i):a}function C(e){return(0,c.isTable)(e)?(0,c.getTableColumns)(e):(0,c.getViewSelectedFields)(e)}function w(e,n,t,i){let r={};for(let[s,a]of Object.entries(e)){if(!(0,c.is)(a,c.Column)&&!(0,c.is)(a,c.SQL)&&!(0,c.is)(a,c.SQL.Aliased)&&typeof a=="object"){let W=(0,c.isTable)(a)||(0,c.isView)(a)?C(a):a;r[s]=w(W,n[s]??{},t,i);continue}let p=n[s];if(p!==void 0&&typeof p!="function"){r[s]=p;continue}let d=(0,c.is)(a,c.Column)?a:void 0,x=d?v(d,i):u.z.any(),$=typeof p=="function"?p(x):x;t.never(d)||(r[s]=$,d&&(t.nullable(d)&&(r[s]=r[s].nullable()),t.optional(d)&&(r[s]=r[s].optional())))}return u.z.object(r)}var ae={never:e=>e?.generated?.type==="always"||e?.generatedIdentity?.type==="always",optional:e=>!e.notNull||e.notNull&&e.hasDefault,nullable:e=>!e.notNull};var U=(e,n)=>{let t=C(e);return w(t,n??{},ae)};var f=(0,g.pgTable)("plans",{id:(0,g.serial)("id").primaryKey(),name:(0,g.text)("name").notNull(),speed:(0,g.text)("speed").notNull(),price:(0,g.text)("price").notNull(),description:(0,g.text)("description"),features:(0,g.jsonb)("features").$type().notNull(),isHighlighted:(0,g.boolean)("is_highlighted").default(!1),category:(0,g.text)("category").default("internet")}),oe=U(f);var b=S(require("path"),1),{Pool:le}=R.default;if(!process.env.DATABASE_URL)throw new Error("DATABASE_URL must be set. Did you forget to provision a database?");var ce=new le({connectionString:process.env.DATABASE_URL,ssl:{rejectUnauthorized:!1}}),N=(0,F.drizzle)(ce,{schema:T});(async()=>{try{if(!process.env.DATABASE_URL){console.warn("DATABASE_URL not set, skipping migrations");return}let e=b.default.resolve(process.cwd(),"migrations"),n=await import("fs");n.existsSync(e)&&n.existsSync(b.default.join(e,"meta","_journal.json"))?(console.log("Running migrations..."),await(0,X.migrate)(N,{migrationsFolder:e}),console.log("Migrations completed.")):console.log("No migration files found or journal missing, skipping auto-migration.")}catch(e){console.error("Migration failed:",e)}})();var V=require("drizzle-orm"),_=class{async getPlans(){return await N.select().from(f)}async getPlan(n){return(await N.select().from(f).where((0,V.eq)(f.id,n)))[0]}async seedPlans(){(await N.select().from(f)).length===0&&await N.insert(f).values([{name:"B\xE1sico",speed:"300 MEGA",price:"79,90",features:["Wi-Fi Gr\xE1tis","Instala\xE7\xE3o Gr\xE1tis","Suporte 24h","Fibra \xD3ptica"],category:"internet",isHighlighted:!1},{name:"Essencial",speed:"400 MEGA",price:"89,90",features:["Wi-Fi Gr\xE1tis","Instala\xE7\xE3o Gr\xE1tis","Suporte 24h","Fibra \xD3ptica"],category:"internet",isHighlighted:!1},{name:"Intermedi\xE1rio",speed:"500 MEGA",price:"99,90",features:["Wi-Fi Gr\xE1tis","Instala\xE7\xE3o Gr\xE1tis","Suporte 24h","Fibra \xD3ptica"],category:"internet",isHighlighted:!0},{name:"Avan\xE7ado",speed:"600 MEGA",price:"109,90",features:["Wi-Fi Gr\xE1tis","Instala\xE7\xE3o Gr\xE1tis","Suporte 24h","Fibra \xD3ptica"],category:"internet",isHighlighted:!1},{name:"Ultra",speed:"700 MEGA",price:"119,90",features:["Wi-Fi Gr\xE1tis","Instala\xE7\xE3o Gr\xE1tis","Suporte 24h","Fibra \xD3ptica"],category:"internet",isHighlighted:!1},{name:"Gamer",speed:"800 MEGA",price:"129,90",features:["Wi-Fi Gr\xE1tis","Instala\xE7\xE3o Gr\xE1tis","Suporte 24h","Fibra \xD3ptica"],category:"internet",isHighlighted:!1},{name:"Premium",speed:"900 MEGA",price:"139,90",features:["Wi-Fi Gr\xE1tis","Instala\xE7\xE3o Gr\xE1tis","Suporte 24h","Fibra \xD3ptica"],category:"internet",isHighlighted:!1},{name:"Canais Light",speed:"100+ Canais",price:"17,90",features:["Canais abertos entre outros","Qualidade HD","Suporte para TV, iOS, Android e Web","Lista de canais"],category:"tv",isHighlighted:!1},{name:"Canais Plus",speed:"150+ Canais",price:"39,90",features:["Canais abertos entre outros","Qualidade HD","Suporte para TV, iOS, Android e Web","Lista de canais"],category:"tv",isHighlighted:!1},{name:"Canais Ultra",speed:"200+ Canais",price:"53,90",features:["Canais abertos entre outros","Qualidade HD","Suporte para TV, iOS, Android e Web","Lista de canais"],category:"tv",isHighlighted:!0},{name:"Canais Ultra 1P + HBO",speed:"200+ Canais + HBO",price:"70,90",features:["Canais abertos entre outros","Qualidade HD","Suporte para TV, iOS, Android e Web","Lista de canais"],category:"tv",isHighlighted:!1},{name:"C\xE2mera de Seguran\xE7a",speed:"C\xE2mera",price:"25,00",features:["Acesse de onde estiver","Aplicativo para Android e iOS","Vis\xE3o Noturna","C\xE2mera Full HD"],category:"adicionais",isHighlighted:!1},{name:"Roteador Extra",speed:"WIFI 6",price:"25,00",features:["Maior Alcance","Tecnologia Mesh","F\xE1cil Configura\xE7\xE3o","Gigabit"],category:"adicionais",isHighlighted:!1},{name:"TV Box",speed:"Android TV",price:"25,00",features:["Transforma sua TV","Acesso a Apps","Resolu\xE7\xE3o Full HD","Controle Remoto"],category:"adicionais",isHighlighted:!1}])}},M=new _;var m=require("zod"),pe={validation:m.z.object({message:m.z.string(),field:m.z.string().optional()}),notFound:m.z.object({message:m.z.string()}),internal:m.z.object({message:m.z.string()})},A={plans:{list:{method:"GET",path:"/api/plans",responses:{200:m.z.array(m.z.custom())}},get:{method:"GET",path:"/api/plans/:id",responses:{200:m.z.custom(),404:pe.notFound}}}};async function j(e,n){return n.get(A.plans.list.path,async(t,i)=>{let r=await M.getPlans();i.json(r)}),n.get(A.plans.get.path,async(t,i)=>{let r=await M.getPlan(Number(t.params.id));if(!r)return i.status(404).json({message:"Plan not found"});i.json(r)}),e}var H=S(require("express"),1),q=S(require("fs"),1),E=S(require("path"),1);function B(e){let n=E.default.resolve(__dirname,"public");if(!q.default.existsSync(n))throw new Error(`Could not find the build directory: ${n}, make sure to build the client first`);e.use(H.default.static(n)),e.use("*",(t,i)=>{i.sendFile(E.default.resolve(n,"index.html"))})}var O=require("http"),h=(0,y.default)(),L=(0,O.createServer)(h);h.use(y.default.json({verify:(e,n,t)=>{e.rawBody=t}}));h.use(y.default.urlencoded({extended:!1}));function P(e,n="express"){let t=new Date().toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",second:"2-digit",hour12:!0});console.log(`${t} [${n}] ${e}`)}h.use((e,n,t)=>{let i=Date.now(),r=e.path,s,a=n.json;n.json=function(p,...d){return s=p,a.apply(n,[p,...d])},n.on("finish",()=>{let p=Date.now()-i;if(r.startsWith("/api")){let d=`${e.method} ${r} ${n.statusCode} in ${p}ms`;s&&(d+=` :: ${JSON.stringify(s)}`),P(d)}}),t()});(async()=>{await j(L,h),h.use((n,t,i,r)=>{let s=n.status||n.statusCode||500,a=n.message||"Internal Server Error";i.status(s).json({message:a})}),B(h);let e=parseInt(process.env.PORT||"5000",10);L.listen({port:e,host:"0.0.0.0",reusePort:!0},()=>{P(`serving on port ${e}`)})})();0&&(module.exports={log});
2026-01-09T13:01:50.555267248Z [err]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
2026-01-09T13:01:50.555269599Z [err]      at Function.executeUserEntryPoint [as runMain] (node:internal/modules/run_main:164:12)
2026-01-09T13:01:50.555280206Z [err]  
2026-01-09T13:01:50.555284279Z [err]      at node:internal/main/run_main_module:28:49
2026-01-09T13:01:50.555290740Z [err]  Error: DATABASE_URL must be set. Did you forget to provision a database?
2026-01-09T13:01:50.555297584Z [err]  
2026-01-09T13:01:50.555300943Z [err]      at Object.<anonymous> (/app/dist/index.cjs:1:5913)
2026-01-09T13:01:50.555310423Z [err]      at Module._compile (node:internal/modules/cjs/loader:1521:14)
2026-01-09T13:01:50.555311059Z [err]  Node.js v20.19.6
2026-01-09T13:01:50.555321994Z [err]      at Module._extensions..js (node:internal/modules/cjs/loader:1623:10)
2026-01-09T13:01:50.555327293Z [err]      at Module.load (node:internal/modules/cjs/loader:1266:32)
2026-01-09T13:01:50.555333120Z [err]      at Module._load (node:internal/modules/cjs/loader:1091:12)
2026-01-09T13:01:51.502783052Z [err]  /app/dist/index.cjs:1
2026-01-09T13:01:51.503399574Z [err]  "use strict";var z=Object.create;var I=Object.defineProperty;var Q=Object.getOwnPropertyDescriptor;var k=Object.getOwnPropertyNames;var J=Object.getPrototypeOf,Y=Object.prototype.hasOwnProperty;var G=(e,n)=>{for(var t in n)I(e,t,{get:n[t],enumerable:!0})},D=(e,n,t,i)=>{if(n&&typeof n=="object"||typeof n=="function")for(let r of k(n))!Y.call(e,r)&&r!==t&&I(e,r,{get:()=>n[r],enumerable:!(i=Q(n,r))||i.enumerable});return e};var S=(e,n,t)=>(t=e!=null?z(J(e)):{},D(n||!e||!e.__esModule?I(t,"default",{value:e,enumerable:!0}):t,e)),K=e=>D(I({},"__esModule",{value:!0}),e);var ue={};G(ue,{log:()=>P});module.exports=K(ue);var y=S(require("express"),1);var F=require("drizzle-orm/node-postgres"),X=require("drizzle-orm/node-postgres/migrator"),R=S(require("pg"),1);var T={};G(T,{insertPlanSchema:()=>oe,plans:()=>f});var g=require("drizzle-orm/pg-core");var c=require("drizzle-orm"),u=require("zod"),o={INT8_MIN:-128,INT8_MAX:127,INT8_UNSIGNED_MAX:255,INT16_MIN:-32768,INT16_MAX:32767,INT16_UNSIGNED_MAX:65535,INT24_MIN:-8388608,INT24_MAX:8388607,INT24_UNSIGNED_MAX:16777215,INT32_MIN:-2147483648,INT32_MAX:2147483647,INT32_UNSIGNED_MAX:4294967295,INT48_MIN:-0x800000000000,INT48_MAX:0x7fffffffffff,INT48_UNSIGNED_MAX:0xffffffffffff,INT64_MIN:-9223372036854775808n,INT64_MAX:9223372036854775807n,INT64_UNSIGNED_MAX:18446744073709551615n};function l(e,n){return n.includes(e.columnType)}function Z(e){return"enumValues"in e&&Array.isArray(e.enumValues)&&e.enumValues.length>0}var ee=u.z.union([u.z.string(),u.z.number(),u.z.boolean(),u.z.null()]),te=u.z.union([ee,u.z.record(u.z.any()),u.z.array(u.z.any())]),re=u.z.custom(e=>e instanceof Buffer);function v(e,n){let t=n?.zodInstance??u.z,i=n?.coerce??{},r;return Z(e)&&(r=e.enumValues.length?t.enum(e.enumValues):t.string()),r||(l(e,["PgGeometry","PgPointTuple"])?r=t.tuple([t.number(),t.number()]):l(e,["PgGeometryObject","PgPointObject"])?r=t.object({x:t.number(),y:t.number()}):l(e,["PgHalfVector","PgVector"])?(r=t.array(t.number()),r=e.dimensions?r.length(e.dimensions):r):l(e,["PgLine"])?r=t.tuple([t.number(),t.number(),t.number()]):l(e,["PgLineABC"])?r=t.object({a:t.number(),b:t.number(),c:t.number()}):l(e,["PgArray"])?(r=t.array(v(e.baseColumn,t)),r=e.size?r.length(e.size):r):e.dataType==="array"?r=t.array(t.any()):e.dataType==="number"?r=ne(e,t,i):e.dataType==="bigint"?r=ie(e,t,i):e.dataType==="boolean"?r=i===!0||i.boolean?t.coerce.boolean():t.boolean():e.dataType==="date"?r=i===!0||i.date?t.coerce.date():t.date():e.dataType==="string"?r=se(e,t,i):e.dataType==="json"?r=te:e.dataType==="custom"?r=t.any():e.dataType==="buffer"&&(r=re)),r||(r=t.any()),r}function ne(e,n,t){let i=e.getSQLType().includes("unsigned"),r,s,a=!1;l(e,["MySqlTinyInt","SingleStoreTinyInt"])?(r=i?0:o.INT8_MIN,s=i?o.INT8_UNSIGNED_MAX:o.INT8_MAX,a=!0):l(e,["PgSmallInt","PgSmallSerial","MySqlSmallInt","SingleStoreSmallInt"])?(r=i?0:o.INT16_MIN,s=i?o.INT16_UNSIGNED_MAX:o.INT16_MAX,a=!0):l(e,["PgReal","MySqlFloat","MySqlMediumInt","SingleStoreMediumInt","SingleStoreFloat"])?(r=i?0:o.INT24_MIN,s=i?o.INT24_UNSIGNED_MAX:o.INT24_MAX,a=l(e,["MySqlMediumInt","SingleStoreMediumInt"])):l(e,["PgInteger","PgSerial","MySqlInt","SingleStoreInt"])?(r=i?0:o.INT32_MIN,s=i?o.INT32_UNSIGNED_MAX:o.INT32_MAX,a=!0):l(e,["PgDoublePrecision","MySqlReal","MySqlDouble","SingleStoreReal","SingleStoreDouble","SQLiteReal"])?(r=i?0:o.INT48_MIN,s=i?o.INT48_UNSIGNED_MAX:o.INT48_MAX):l(e,["PgBigInt53","PgBigSerial53","MySqlBigInt53","MySqlSerial","SingleStoreBigInt53","SingleStoreSerial","SQLiteInteger"])?(i=i||l(e,["MySqlSerial","SingleStoreSerial"]),r=i?0:Number.MIN_SAFE_INTEGER,s=Number.MAX_SAFE_INTEGER,a=!0):l(e,["MySqlYear","SingleStoreYear"])?(r=1901,s=2155,a=!0):(r=Number.MIN_SAFE_INTEGER,s=Number.MAX_SAFE_INTEGER);let p=t===!0||t?.number?n.coerce.number():n.number();return p=p.min(r).max(s),a?p.int():p}function ie(e,n,t){let i=e.getSQLType().includes("unsigned"),r=i?0n:o.INT64_MIN,s=i?o.INT64_UNSIGNED_MAX:o.INT64_MAX;return(t===!0||t?.bigint?n.coerce.bigint():n.bigint()).min(r).max(s)}function se(e,n,t){if(l(e,["PgUUID"]))return n.string().uuid();let i,r,s=!1;l(e,["PgVarchar","SQLiteText"])?i=e.length:l(e,["MySqlVarChar","SingleStoreVarChar"])?i=e.length??o.INT16_UNSIGNED_MAX:l(e,["MySqlText","SingleStoreText"])&&(e.textType==="longtext"?i=o.INT32_UNSIGNED_MAX:e.textType==="mediumtext"?i=o.INT24_UNSIGNED_MAX:e.textType==="text"?i=o.INT16_UNSIGNED_MAX:i=o.INT8_UNSIGNED_MAX),l(e,["PgChar","MySqlChar","SingleStoreChar"])&&(i=e.length,s=!0),l(e,["PgBinaryVector"])&&(r=/^[01]+$/,i=e.dimensions);let a=t===!0||t?.string?n.coerce.string():n.string();return a=r?a.regex(r):a,i&&s?a.length(i):i?a.max(i):a}function C(e){return(0,c.isTable)(e)?(0,c.getTableColumns)(e):(0,c.getViewSelectedFields)(e)}function w(e,n,t,i){let r={};for(let[s,a]of Object.entries(e)){if(!(0,c.is)(a,c.Column)&&!(0,c.is)(a,c.SQL)&&!(0,c.is)(a,c.SQL.Aliased)&&typeof a=="object"){let W=(0,c.isTable)(a)||(0,c.isView)(a)?C(a):a;r[s]=w(W,n[s]??{},t,i);continue}let p=n[s];if(p!==void 0&&typeof p!="function"){r[s]=p;continue}let d=(0,c.is)(a,c.Column)?a:void 0,x=d?v(d,i):u.z.any(),$=typeof p=="function"?p(x):x;t.never(d)||(r[s]=$,d&&(t.nullable(d)&&(r[s]=r[s].nullable()),t.optional(d)&&(r[s]=r[s].optional())))}return u.z.object(r)}var ae={never:e=>e?.generated?.type==="always"||e?.generatedIdentity?.type==="always",optional:e=>!e.notNull||e.notNull&&e.hasDefault,nullable:e=>!e.notNull};var U=(e,n)=>{let t=C(e);return w(t,n??{},ae)};var f=(0,g.pgTable)("plans",{id:(0,g.serial)("id").primaryKey(),name:(0,g.text)("name").notNull(),speed:(0,g.text)("speed").notNull(),price:(0,g.text)("price").notNull(),description:(0,g.text)("description"),features:(0,g.jsonb)("features").$type().notNull(),isHighlighted:(0,g.boolean)("is_highlighted").default(!1),category:(0,g.text)("category").default("internet")}),oe=U(f);var b=S(require("path"),1),{Pool:le}=R.default;if(!process.env.DATABASE_URL)throw new Error("DATABASE_URL must be set. Did you forget to provision a database?");var ce=new le({connectionString:process.env.DATABASE_URL,ssl:{rejectUnauthorized:!1}}),N=(0,F.drizzle)(ce,{schema:T});(async()=>{try{if(!process.env.DATABASE_URL){console.warn("DATABASE_URL not set, skipping migrations");return}let e=b.default.resolve(process.cwd(),"migrations"),n=await import("fs");n.existsSync(e)&&n.existsSync(b.default.join(e,"meta","_journal.json"))?(console.log("Running migrations..."),await(0,X.migrate)(N,{migrationsFolder:e}),console.log("Migrations completed.")):console.log("No migration files found or journal missing, skipping auto-migration.")}catch(e){console.error("Migration failed:",e)}})();var V=require("drizzle-orm"),_=class{async getPlans(){return await N.select().from(f)}async getPlan(n){return(await N.select().from(f).where((0,V.eq)(f.id,n)))[0]}async seedPlans(){(await N.select().from(f)).length===0&&await N.insert(f).values([{name:"B\xE1sico",speed:"300 MEGA",price:"79,90",features:["Wi-Fi Gr\xE1tis","Instala\xE7\xE3o Gr\xE1tis","Suporte 24h","Fibra \xD3ptica"],category:"internet",isHighlighted:!1},{name:"Essencial",speed:"400 MEGA",price:"89,90",features:["Wi-Fi Gr\xE1tis","Instala\xE7\xE3o Gr\xE1tis","Suporte 24h","Fibra \xD3ptica"],category:"internet",isHighlighted:!1},{name:"Intermedi\xE1rio",speed:"500 MEGA",price:"99,90",features:["Wi-Fi Gr\xE1tis","Instala\xE7\xE3o Gr\xE1tis","Suporte 24h","Fibra \xD3ptica"],category:"internet",isHighlighted:!0},{name:"Avan\xE7ado",speed:"600 MEGA",price:"109,90",features:["Wi-Fi Gr\xE1tis","Instala\xE7\xE3o Gr\xE1tis","Suporte 24h","Fibra \xD3ptica"],category:"internet",isHighlighted:!1},{name:"Ultra",speed:"700 MEGA",price:"119,90",features:["Wi-Fi Gr\xE1tis","Instala\xE7\xE3o Gr\xE1tis","Suporte 24h","Fibra \xD3ptica"],category:"internet",isHighlighted:!1},{name:"Gamer",speed:"800 MEGA",price:"129,90",features:["Wi-Fi Gr\xE1tis","Instala\xE7\xE3o Gr\xE1tis","Suporte 24h","Fibra \xD3ptica"],category:"internet",isHighlighted:!1},{name:"Premium",speed:"900 MEGA",price:"139,90",features:["Wi-Fi Gr\xE1tis","Instala\xE7\xE3o Gr\xE1tis","Suporte 24h","Fibra \xD3ptica"],category:"internet",isHighlighted:!1},{name:"Canais Light",speed:"100+ Canais",price:"17,90",features:["Canais abertos entre outros","Qualidade HD","Suporte para TV, iOS, Android e Web","Lista de canais"],category:"tv",isHighlighted:!1},{name:"Canais Plus",speed:"150+ Canais",price:"39,90",features:["Canais abertos entre outros","Qualidade HD","Suporte para TV, iOS, Android e Web","Lista de canais"],category:"tv",isHighlighted:!1},{name:"Canais Ultra",speed:"200+ Canais",price:"53,90",features:["Canais abertos entre outros","Qualidade HD","Suporte para TV, iOS, Android e Web","Lista de canais"],category:"tv",isHighlighted:!0},{name:"Canais Ultra 1P + HBO",speed:"200+ Canais + HBO",price:"70,90",features:["Canais abertos entre outros","Qualidade HD","Suporte para TV, iOS, Android e Web","Lista de canais"],category:"tv",isHighlighted:!1},{name:"C\xE2mera de Seguran\xE7a",speed:"C\xE2mera",price:"25,00",features:["Acesse de onde estiver","Aplicativo para Android e iOS","Vis\xE3o Noturna","C\xE2mera Full HD"],category:"adicionais",isHighlighted:!1},{name:"Roteador Extra",speed:"WIFI 6",price:"25,00",features:["Maior Alcance","Tecnologia Mesh","F\xE1cil Configura\xE7\xE3o","Gigabit"],category:"adicionais",isHighlighted:!1},{name:"TV Box",speed:"Android TV",price:"25,00",features:["Transforma sua TV","Acesso a Apps","Resolu\xE7\xE3o Full HD","Controle Remoto"],category:"adicionais",isHighlighted:!1}])}},M=new _;var m=require("zod"),pe={validation:m.z.object({message:m.z.string(),field:m.z.string().optional()}),notFound:m.z.object({message:m.z.string()}),internal:m.z.object({message:m.z.string()})},A={plans:{list:{method:"GET",path:"/api/plans",responses:{200:m.z.array(m.z.custom())}},get:{method:"GET",path:"/api/plans/:id",responses:{200:m.z.custom(),404:pe.notFound}}}};async function j(e,n){return n.get(A.plans.list.path,async(t,i)=>{let r=await M.getPlans();i.json(r)}),n.get(A.plans.get.path,async(t,i)=>{let r=await M.getPlan(Number(t.params.id));if(!r)return i.status(404).json({message:"Plan not found"});i.json(r)}),e}var H=S(require("express"),1),q=S(require("fs"),1),E=S(require("path"),1);function B(e){let n=E.default.resolve(__dirname,"public");if(!q.default.existsSync(n))throw new Error(`Could not find the build directory: ${n}, make sure to build the client first`);e.use(H.default.static(n)),e.use("*",(t,i)=>{i.sendFile(E.default.resolve(n,"index.html"))})}var O=require("http"),h=(0,y.default)(),L=(0,O.createServer)(h);h.use(y.default.json({verify:(e,n,t)=>{e.rawBody=t}}));h.use(y.default.urlencoded({extended:!1}));function P(e,n="express"){let t=new Date().toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",second:"2-digit",hour12:!0});console.log(`${t} [${n}] ${e}`)}h.use((e,n,t)=>{let i=Date.now(),r=e.path,s,a=n.json;n.json=function(p,...d){return s=p,a.apply(n,[p,...d])},n.on("finish",()=>{let p=Date.now()-i;if(r.startsWith("/api")){let d=`${e.method} ${r} ${n.statusCode} in ${p}ms`;s&&(d+=` :: ${JSON.stringify(s)}`),P(d)}}),t()});(async()=>{await j(L,h),h.use((n,t,i,r)=>{let s=n.status||n.statusCode||500,a=n.message||"Internal Server Error";i.status(s).json({message:a})}),B(h);let e=parseInt(process.env.PORT||"5000",10);L.listen({port:e,host:"0.0.0.0",reusePort:!0},()=>{P(`serving on port ${e}`)})})();0&&(module.exports={log});
2026-01-09T13:01:51.504707626Z [err]      at Function.executeUserEntryPoint [as runMain] (node:internal/modules/run_main:164:12)
2026-01-09T13:01:51.504728825Z [err]      at node:internal/main/run_main_module:28:49
2026-01-09T13:01:51.504739919Z [err]  
2026-01-09T13:01:51.504748753Z [err]  Node.js v20.19.6
2026-01-09T13:01:51.504759244Z [err]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
2026-01-09T13:01:51.504763900Z [err]  
2026-01-09T13:01:51.504768769Z [err]  Error: DATABASE_URL must be set. Did you forget to provision a database?
2026-01-09T13:01:51.504774051Z [err]      at Object.<anonymous> (/app/dist/index.cjs:1:5913)
2026-01-09T13:01:51.504778890Z [err]      at Module._compile (node:internal/modules/cjs/loader:1521:14)
2026-01-09T13:01:51.504783371Z [err]      at Module._extensions..js (node:internal/modules/cjs/loader:1623:10)
2026-01-09T13:01:51.504788063Z [err]      at Module.load (node:internal/modules/cjs/loader:1266:32)
2026-01-09T13:01:51.504793766Z [err]      at Module._load (node:internal/modules/cjs/loader:1091:12)
2026-01-09T13:01:52.378232557Z [err]  /app/dist/index.cjs:1
2026-01-09T13:01:52.427201029Z [err]  "use strict";var z=Object.create;var I=Object.defineProperty;var Q=Object.getOwnPropertyDescriptor;var k=Object.getOwnPropertyNames;var J=Object.getPrototypeOf,Y=Object.prototype.hasOwnProperty;var G=(e,n)=>{for(var t in n)I(e,t,{get:n[t],enumerable:!0})},D=(e,n,t,i)=>{if(n&&typeof n=="object"||typeof n=="function")for(let r of k(n))!Y.call(e,r)&&r!==t&&I(e,r,{get:()=>n[r],enumerable:!(i=Q(n,r))||i.enumerable});return e};var S=(e,n,t)=>(t=e!=null?z(J(e)):{},D(n||!e||!e.__esModule?I(t,"default",{value:e,enumerable:!0}):t,e)),K=e=>D(I({},"__esModule",{value:!0}),e);var ue={};G(ue,{log:()=>P});module.exports=K(ue);var y=S(require("express"),1);var F=require("drizzle-orm/node-postgres"),X=require("drizzle-orm/node-postgres/migrator"),R=S(require("pg"),1);var T={};G(T,{insertPlanSchema:()=>oe,plans:()=>f});var g=require("drizzle-orm/pg-core");var c=require("drizzle-orm"),u=require("zod"),o={INT8_MIN:-128,INT8_MAX:127,INT8_UNSIGNED_MAX:255,INT16_MIN:-32768,INT16_MAX:32767,INT16_UNSIGNED_MAX:65535,INT24_MIN:-8388608,INT24_MAX:8388607,INT24_UNSIGNED_MAX:16777215,INT32_MIN:-2147483648,INT32_MAX:2147483647,INT32_UNSIGNED_MAX:4294967295,INT48_MIN:-0x800000000000,INT48_MAX:0x7fffffffffff,INT48_UNSIGNED_MAX:0xffffffffffff,INT64_MIN:-9223372036854775808n,INT64_MAX:9223372036854775807n,INT64_UNSIGNED_MAX:18446744073709551615n};function l(e,n){return n.includes(e.columnType)}function Z(e){return"enumValues"in e&&Array.isArray(e.enumValues)&&e.enumValues.length>0}var ee=u.z.union([u.z.string(),u.z.number(),u.z.boolean(),u.z.null()]),te=u.z.union([ee,u.z.record(u.z.any()),u.z.array(u.z.any())]),re=u.z.custom(e=>e instanceof Buffer);function v(e,n){let t=n?.zodInstance??u.z,i=n?.coerce??{},r;return Z(e)&&(r=e.enumValues.length?t.enum(e.enumValues):t.string()),r||(l(e,["PgGeometry","PgPointTuple"])?r=t.tuple([t.number(),t.number()]):l(e,["PgGeometryObject","PgPointObject"])?r=t.object({x:t.number(),y:t.number()}):l(e,["PgHalfVector","PgVector"])?(r=t.array(t.number()),r=e.dimensions?r.length(e.dimensions):r):l(e,["PgLine"])?r=t.tuple([t.number(),t.number(),t.number()]):l(e,["PgLineABC"])?r=t.object({a:t.number(),b:t.number(),c:t.number()}):l(e,["PgArray"])?(r=t.array(v(e.baseColumn,t)),r=e.size?r.length(e.size):r):e.dataType==="array"?r=t.array(t.any()):e.dataType==="number"?r=ne(e,t,i):e.dataType==="bigint"?r=ie(e,t,i):e.dataType==="boolean"?r=i===!0||i.boolean?t.coerce.boolean():t.boolean():e.dataType==="date"?r=i===!0||i.date?t.coerce.date():t.date():e.dataType==="string"?r=se(e,t,i):e.dataType==="json"?r=te:e.dataType==="custom"?r=t.any():e.dataType==="buffer"&&(r=re)),r||(r=t.any()),r}function ne(e,n,t){let i=e.getSQLType().includes("unsigned"),r,s,a=!1;l(e,["MySqlTinyInt","SingleStoreTinyInt"])?(r=i?0:o.INT8_MIN,s=i?o.INT8_UNSIGNED_MAX:o.INT8_MAX,a=!0):l(e,["PgSmallInt","PgSmallSerial","MySqlSmallInt","SingleStoreSmallInt"])?(r=i?0:o.INT16_MIN,s=i?o.INT16_UNSIGNED_MAX:o.INT16_MAX,a=!0):l(e,["PgReal","MySqlFloat","MySqlMediumInt","SingleStoreMediumInt","SingleStoreFloat"])?(r=i?0:o.INT24_MIN,s=i?o.INT24_UNSIGNED_MAX:o.INT24_MAX,a=l(e,["MySqlMediumInt","SingleStoreMediumInt"])):l(e,["PgInteger","PgSerial","MySqlInt","SingleStoreInt"])?(r=i?0:o.INT32_MIN,s=i?o.INT32_UNSIGNED_MAX:o.INT32_MAX,a=!0):l(e,["PgDoublePrecision","MySqlReal","MySqlDouble","SingleStoreReal","SingleStoreDouble","SQLiteReal"])?(r=i?0:o.INT48_MIN,s=i?o.INT48_UNSIGNED_MAX:o.INT48_MAX):l(e,["PgBigInt53","PgBigSerial53","MySqlBigInt53","MySqlSerial","SingleStoreBigInt53","SingleStoreSerial","SQLiteInteger"])?(i=i||l(e,["MySqlSerial","SingleStoreSerial"]),r=i?0:Number.MIN_SAFE_INTEGER,s=Number.MAX_SAFE_INTEGER,a=!0):l(e,["MySqlYear","SingleStoreYear"])?(r=1901,s=2155,a=!0):(r=Number.MIN_SAFE_INTEGER,s=Number.MAX_SAFE_INTEGER);let p=t===!0||t?.number?n.coerce.number():n.number();return p=p.min(r).max(s),a?p.int():p}function ie(e,n,t){let i=e.getSQLType().includes("unsigned"),r=i?0n:o.INT64_MIN,s=i?o.INT64_UNSIGNED_MAX:o.INT64_MAX;return(t===!0||t?.bigint?n.coerce.bigint():n.bigint()).min(r).max(s)}function se(e,n,t){if(l(e,["PgUUID"]))return n.string().uuid();let i,r,s=!1;l(e,["PgVarchar","SQLiteText"])?i=e.length:l(e,["MySqlVarChar","SingleStoreVarChar"])?i=e.length??o.INT16_UNSIGNED_MAX:l(e,["MySqlText","SingleStoreText"])&&(e.textType==="longtext"?i=o.INT32_UNSIGNED_MAX:e.textType==="mediumtext"?i=o.INT24_UNSIGNED_MAX:e.textType==="text"?i=o.INT16_UNSIGNED_MAX:i=o.INT8_UNSIGNED_MAX),l(e,["PgChar","MySqlChar","SingleStoreChar"])&&(i=e.length,s=!0),l(e,["PgBinaryVector"])&&(r=/^[01]+$/,i=e.dimensions);let a=t===!0||t?.string?n.coerce.string():n.string();return a=r?a.regex(r):a,i&&s?a.length(i):i?a.max(i):a}function C(e){return(0,c.isTable)(e)?(0,c.getTableColumns)(e):(0,c.getViewSelectedFields)(e)}function w(e,n,t,i){let r={};for(let[s,a]of Object.entries(e)){if(!(0,c.is)(a,c.Column)&&!(0,c.is)(a,c.SQL)&&!(0,c.is)(a,c.SQL.Aliased)&&typeof a=="object"){let W=(0,c.isTable)(a)||(0,c.isView)(a)?C(a):a;r[s]=w(W,n[s]??{},t,i);continue}let p=n[s];if(p!==void 0&&typeof p!="function"){r[s]=p;continue}let d=(0,c.is)(a,c.Column)?a:void 0,x=d?v(d,i):u.z.any(),$=typeof p=="function"?p(x):x;t.never(d)||(r[s]=$,d&&(t.nullable(d)&&(r[s]=r[s].nullable()),t.optional(d)&&(r[s]=r[s].optional())))}return u.z.object(r)}var ae={never:e=>e?.generated?.type==="always"||e?.generatedIdentity?.type==="always",optional:e=>!e.notNull||e.notNull&&e.hasDefault,nullable:e=>!e.notNull};var U=(e,n)=>{let t=C(e);return w(t,n??{},ae)};var f=(0,g.pgTable)("plans",{id:(0,g.serial)("id").primaryKey(),name:(0,g.text)("name").notNull(),speed:(0,g.text)("speed").notNull(),price:(0,g.text)("price").notNull(),description:(0,g.text)("description"),features:(0,g.jsonb)("features").$type().notNull(),isHighlighted:(0,g.boolean)("is_highlighted").default(!1),category:(0,g.text)("category").default("internet")}),oe=U(f);var b=S(require("path"),1),{Pool:le}=R.default;if(!process.env.DATABASE_URL)throw new Error("DATABASE_URL must be set. Did you forget to provision a database?");var ce=new le({connectionString:process.env.DATABASE_URL,ssl:{rejectUnauthorized:!1}}),N=(0,F.drizzle)(ce,{schema:T});(async()=>{try{if(!process.env.DATABASE_URL){console.warn("DATABASE_URL not set, skipping migrations");return}let e=b.default.resolve(process.cwd(),"migrations"),n=await import("fs");n.existsSync(e)&&n.existsSync(b.default.join(e,"meta","_journal.json"))?(console.log("Running migrations..."),await(0,X.migrate)(N,{migrationsFolder:e}),console.log("Migrations completed.")):console.log("No migration files found or journal missing, skipping auto-migration.")}catch(e){console.error("Migration failed:",e)}})();var V=require("drizzle-orm"),_=class{async getPlans(){return await N.select().from(f)}async getPlan(n){return(await N.select().from(f).where((0,V.eq)(f.id,n)))[0]}async seedPlans(){(await N.select().from(f)).length===0&&await N.insert(f).values([{name:"B\xE1sico",speed:"300 MEGA",price:"79,90",features:["Wi-Fi Gr\xE1tis","Instala\xE7\xE3o Gr\xE1tis","Suporte 24h","Fibra \xD3ptica"],category:"internet",isHighlighted:!1},{name:"Essencial",speed:"400 MEGA",price:"89,90",features:["Wi-Fi Gr\xE1tis","Instala\xE7\xE3o Gr\xE1tis","Suporte 24h","Fibra \xD3ptica"],category:"internet",isHighlighted:!1},{name:"Intermedi\xE1rio",speed:"500 MEGA",price:"99,90",features:["Wi-Fi Gr\xE1tis","Instala\xE7\xE3o Gr\xE1tis","Suporte 24h","Fibra \xD3ptica"],category:"internet",isHighlighted:!0},{name:"Avan\xE7ado",speed:"600 MEGA",price:"109,90",features:["Wi-Fi Gr\xE1tis","Instala\xE7\xE3o Gr\xE1tis","Suporte 24h","Fibra \xD3ptica"],category:"internet",isHighlighted:!1},{name:"Ultra",speed:"700 MEGA",price:"119,90",features:["Wi-Fi Gr\xE1tis","Instala\xE7\xE3o Gr\xE1tis","Suporte 24h","Fibra \xD3ptica"],category:"internet",isHighlighted:!1},{name:"Gamer",speed:"800 MEGA",price:"129,90",features:["Wi-Fi Gr\xE1tis","Instala\xE7\xE3o Gr\xE1tis","Suporte 24h","Fibra \xD3ptica"],category:"internet",isHighlighted:!1},{name:"Premium",speed:"900 MEGA",price:"139,90",features:["Wi-Fi Gr\xE1tis","Instala\xE7\xE3o Gr\xE1tis","Suporte 24h","Fibra \xD3ptica"],category:"internet",isHighlighted:!1},{name:"Canais Light",speed:"100+ Canais",price:"17,90",features:["Canais abertos entre outros","Qualidade HD","Suporte para TV, iOS, Android e Web","Lista de canais"],category:"tv",isHighlighted:!1},{name:"Canais Plus",speed:"150+ Canais",price:"39,90",features:["Canais abertos entre outros","Qualidade HD","Suporte para TV, iOS, Android e Web","Lista de canais"],category:"tv",isHighlighted:!1},{name:"Canais Ultra",speed:"200+ Canais",price:"53,90",features:["Canais abertos entre outros","Qualidade HD","Suporte para TV, iOS, Android e Web","Lista de canais"],category:"tv",isHighlighted:!0},{name:"Canais Ultra 1P + HBO",speed:"200+ Canais + HBO",price:"70,90",features:["Canais abertos entre outros","Qualidade HD","Suporte para TV, iOS, Android e Web","Lista de canais"],category:"tv",isHighlighted:!1},{name:"C\xE2mera de Seguran\xE7a",speed:"C\xE2mera",price:"25,00",features:["Acesse de onde estiver","Aplicativo para Android e iOS","Vis\xE3o Noturna","C\xE2mera Full HD"],category:"adicionais",isHighlighted:!1},{name:"Roteador Extra",speed:"WIFI 6",price:"25,00",features:["Maior Alcance","Tecnologia Mesh","F\xE1cil Configura\xE7\xE3o","Gigabit"],category:"adicionais",isHighlighted:!1},{name:"TV Box",speed:"Android TV",price:"25,00",features:["Transforma sua TV","Acesso a Apps","Resolu\xE7\xE3o Full HD","Controle Remoto"],category:"adicionais",isHighlighted:!1}])}},M=new _;var m=require("zod"),pe={validation:m.z.object({message:m.z.string(),field:m.z.string().optional()}),notFound:m.z.object({message:m.z.string()}),internal:m.z.object({message:m.z.string()})},A={plans:{list:{method:"GET",path:"/api/plans",responses:{200:m.z.array(m.z.custom())}},get:{method:"GET",path:"/api/plans/:id",responses:{200:m.z.custom(),404:pe.notFound}}}};async function j(e,n){return n.get(A.plans.list.path,async(t,i)=>{let r=await M.getPlans();i.json(r)}),n.get(A.plans.get.path,async(t,i)=>{let r=await M.getPlan(Number(t.params.id));if(!r)return i.status(404).json({message:"Plan not found"});i.json(r)}),e}var H=S(require("express"),1),q=S(require("fs"),1),E=S(require("path"),1);function B(e){let n=E.default.resolve(__dirname,"public");if(!q.default.existsSync(n))throw new Error(`Could not find the build directory: ${n}, make sure to build the client first`);e.use(H.default.static(n)),e.use("*",(t,i)=>{i.sendFile(E.default.resolve(n,"index.html"))})}var O=require("http"),h=(0,y.default)(),L=(0,O.createServer)(h);h.use(y.default.json({verify:(e,n,t)=>{e.rawBody=t}}));h.use(y.default.urlencoded({extended:!1}));function P(e,n="express"){let t=new Date().toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",second:"2-digit",hour12:!0});console.log(`${t} [${n}] ${e}`)}h.use((e,n,t)=>{let i=Date.now(),r=e.path,s,a=n.json;n.json=function(p,...d){return s=p,a.apply(n,[p,...d])},n.on("finish",()=>{let p=Date.now()-i;if(r.startsWith("/api")){let d=`${e.method} ${r} ${n.statusCode} in ${p}ms`;s&&(d+=` :: ${JSON.stringify(s)}`),P(d)}}),t()});(async()=>{await j(L,h),h.use((n,t,i,r)=>{let s=n.status||n.statusCode||500,a=n.message||"Internal Server Error";i.status(s).json({message:a})}),B(h);let e=parseInt(process.env.PORT||"5000",10);L.listen({port:e,host:"0.0.0.0",reusePort:!0},()=>{P(`serving on port ${e}`)})})();0&&(module.exports={log});
2026-01-09T13:01:52.427214408Z [err]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
2026-01-09T13:01:52.427222039Z [err]  
2026-01-09T13:01:52.427228732Z [err]  Error: DATABASE_URL must be set. Did you forget to provision a database?
2026-01-09T13:01:52.427234884Z [err]      at Object.<anonymous> (/app/dist/index.cjs:1:5913)
2026-01-09T13:01:52.427240794Z [err]      at Module._compile (node:internal/modules/cjs/loader:1521:14)
2026-01-09T13:01:52.427246107Z [err]      at Module._extensions..js (node:internal/modules/cjs/loader:1623:10)
2026-01-09T13:01:52.427254940Z [err]      at Module.load (node:internal/modules/cjs/loader:1266:32)
2026-01-09T13:01:52.427261623Z [err]      at Module._load (node:internal/modules/cjs/loader:1091:12)
2026-01-09T13:01:52.427266635Z [err]      at Function.executeUserEntryPoint [as runMain] (node:internal/modules/run_main:164:12)
2026-01-09T13:01:52.427274318Z [err]      at node:internal/main/run_main_module:28:49
2026-01-09T13:01:52.427282435Z [err]  
2026-01-09T13:01:52.427291002Z [err]  Node.js v20.19.6
2026-01-09T13:01:53.242597084Z [err]  /app/dist/index.cjs:1
2026-01-09T13:01:53.243157576Z [err]  "use strict";var z=Object.create;var I=Object.defineProperty;var Q=Object.getOwnPropertyDescriptor;var k=Object.getOwnPropertyNames;var J=Object.getPrototypeOf,Y=Object.prototype.hasOwnProperty;var G=(e,n)=>{for(var t in n)I(e,t,{get:n[t],enumerable:!0})},D=(e,n,t,i)=>{if(n&&typeof n=="object"||typeof n=="function")for(let r of k(n))!Y.call(e,r)&&r!==t&&I(e,r,{get:()=>n[r],enumerable:!(i=Q(n,r))||i.enumerable});return e};var S=(e,n,t)=>(t=e!=null?z(J(e)):{},D(n||!e||!e.__esModule?I(t,"default",{value:e,enumerable:!0}):t,e)),K=e=>D(I({},"__esModule",{value:!0}),e);var ue={};G(ue,{log:()=>P});module.exports=K(ue);var y=S(require("express"),1);var F=require("drizzle-orm/node-postgres"),X=require("drizzle-orm/node-postgres/migrator"),R=S(require("pg"),1);var T={};G(T,{insertPlanSchema:()=>oe,plans:()=>f});var g=require("drizzle-orm/pg-core");var c=require("drizzle-orm"),u=require("zod"),o={INT8_MIN:-128,INT8_MAX:127,INT8_UNSIGNED_MAX:255,INT16_MIN:-32768,INT16_MAX:32767,INT16_UNSIGNED_MAX:65535,INT24_MIN:-8388608,INT24_MAX:8388607,INT24_UNSIGNED_MAX:16777215,INT32_MIN:-2147483648,INT32_MAX:2147483647,INT32_UNSIGNED_MAX:4294967295,INT48_MIN:-0x800000000000,INT48_MAX:0x7fffffffffff,INT48_UNSIGNED_MAX:0xffffffffffff,INT64_MIN:-9223372036854775808n,INT64_MAX:9223372036854775807n,INT64_UNSIGNED_MAX:18446744073709551615n};function l(e,n){return n.includes(e.columnType)}function Z(e){return"enumValues"in e&&Array.isArray(e.enumValues)&&e.enumValues.length>0}var ee=u.z.union([u.z.string(),u.z.number(),u.z.boolean(),u.z.null()]),te=u.z.union([ee,u.z.record(u.z.any()),u.z.array(u.z.any())]),re=u.z.custom(e=>e instanceof Buffer);function v(e,n){let t=n?.zodInstance??u.z,i=n?.coerce??{},r;return Z(e)&&(r=e.enumValues.length?t.enum(e.enumValues):t.string()),r||(l(e,["PgGeometry","PgPointTuple"])?r=t.tuple([t.number(),t.number()]):l(e,["PgGeometryObject","PgPointObject"])?r=t.object({x:t.number(),y:t.number()}):l(e,["PgHalfVector","PgVector"])?(r=t.array(t.number()),r=e.dimensions?r.length(e.dimensions):r):l(e,["PgLine"])?r=t.tuple([t.number(),t.number(),t.number()]):l(e,["PgLineABC"])?r=t.object({a:t.number(),b:t.number(),c:t.number()}):l(e,["PgArray"])?(r=t.array(v(e.baseColumn,t)),r=e.size?r.length(e.size):r):e.dataType==="array"?r=t.array(t.any()):e.dataType==="number"?r=ne(e,t,i):e.dataType==="bigint"?r=ie(e,t,i):e.dataType==="boolean"?r=i===!0||i.boolean?t.coerce.boolean():t.boolean():e.dataType==="date"?r=i===!0||i.date?t.coerce.date():t.date():e.dataType==="string"?r=se(e,t,i):e.dataType==="json"?r=te:e.dataType==="custom"?r=t.any():e.dataType==="buffer"&&(r=re)),r||(r=t.any()),r}function ne(e,n,t){let i=e.getSQLType().includes("unsigned"),r,s,a=!1;l(e,["MySqlTinyInt","SingleStoreTinyInt"])?(r=i?0:o.INT8_MIN,s=i?o.INT8_UNSIGNED_MAX:o.INT8_MAX,a=!0):l(e,["PgSmallInt","PgSmallSerial","MySqlSmallInt","SingleStoreSmallInt"])?(r=i?0:o.INT16_MIN,s=i?o.INT16_UNSIGNED_MAX:o.INT16_MAX,a=!0):l(e,["PgReal","MySqlFloat","MySqlMediumInt","SingleStoreMediumInt","SingleStoreFloat"])?(r=i?0:o.INT24_MIN,s=i?o.INT24_UNSIGNED_MAX:o.INT24_MAX,a=l(e,["MySqlMediumInt","SingleStoreMediumInt"])):l(e,["PgInteger","PgSerial","MySqlInt","SingleStoreInt"])?(r=i?0:o.INT32_MIN,s=i?o.INT32_UNSIGNED_MAX:o.INT32_MAX,a=!0):l(e,["PgDoublePrecision","MySqlReal","MySqlDouble","SingleStoreReal","SingleStoreDouble","SQLiteReal"])?(r=i?0:o.INT48_MIN,s=i?o.INT48_UNSIGNED_MAX:o.INT48_MAX):l(e,["PgBigInt53","PgBigSerial53","MySqlBigInt53","MySqlSerial","SingleStoreBigInt53","SingleStoreSerial","SQLiteInteger"])?(i=i||l(e,["MySqlSerial","SingleStoreSerial"]),r=i?0:Number.MIN_SAFE_INTEGER,s=Number.MAX_SAFE_INTEGER,a=!0):l(e,["MySqlYear","SingleStoreYear"])?(r=1901,s=2155,a=!0):(r=Number.MIN_SAFE_INTEGER,s=Number.MAX_SAFE_INTEGER);let p=t===!0||t?.number?n.coerce.number():n.number();return p=p.min(r).max(s),a?p.int():p}function ie(e,n,t){let i=e.getSQLType().includes("unsigned"),r=i?0n:o.INT64_MIN,s=i?o.INT64_UNSIGNED_MAX:o.INT64_MAX;return(t===!0||t?.bigint?n.coerce.bigint():n.bigint()).min(r).max(s)}function se(e,n,t){if(l(e,["PgUUID"]))return n.string().uuid();let i,r,s=!1;l(e,["PgVarchar","SQLiteText"])?i=e.length:l(e,["MySqlVarChar","SingleStoreVarChar"])?i=e.length??o.INT16_UNSIGNED_MAX:l(e,["MySqlText","SingleStoreText"])&&(e.textType==="longtext"?i=o.INT32_UNSIGNED_MAX:e.textType==="mediumtext"?i=o.INT24_UNSIGNED_MAX:e.textType==="text"?i=o.INT16_UNSIGNED_MAX:i=o.INT8_UNSIGNED_MAX),l(e,["PgChar","MySqlChar","SingleStoreChar"])&&(i=e.length,s=!0),l(e,["PgBinaryVector"])&&(r=/^[01]+$/,i=e.dimensions);let a=t===!0||t?.string?n.coerce.string():n.string();return a=r?a.regex(r):a,i&&s?a.length(i):i?a.max(i):a}function C(e){return(0,c.isTable)(e)?(0,c.getTableColumns)(e):(0,c.getViewSelectedFields)(e)}function w(e,n,t,i){let r={};for(let[s,a]of Object.entries(e)){if(!(0,c.is)(a,c.Column)&&!(0,c.is)(a,c.SQL)&&!(0,c.is)(a,c.SQL.Aliased)&&typeof a=="object"){let W=(0,c.isTable)(a)||(0,c.isView)(a)?C(a):a;r[s]=w(W,n[s]??{},t,i);continue}let p=n[s];if(p!==void 0&&typeof p!="function"){r[s]=p;continue}let d=(0,c.is)(a,c.Column)?a:void 0,x=d?v(d,i):u.z.any(),$=typeof p=="function"?p(x):x;t.never(d)||(r[s]=$,d&&(t.nullable(d)&&(r[s]=r[s].nullable()),t.optional(d)&&(r[s]=r[s].optional())))}return u.z.object(r)}var ae={never:e=>e?.generated?.type==="always"||e?.generatedIdentity?.type==="always",optional:e=>!e.notNull||e.notNull&&e.hasDefault,nullable:e=>!e.notNull};var U=(e,n)=>{let t=C(e);return w(t,n??{},ae)};var f=(0,g.pgTable)("plans",{id:(0,g.serial)("id").primaryKey(),name:(0,g.text)("name").notNull(),speed:(0,g.text)("speed").notNull(),price:(0,g.text)("price").notNull(),description:(0,g.text)("description"),features:(0,g.jsonb)("features").$type().notNull(),isHighlighted:(0,g.boolean)("is_highlighted").default(!1),category:(0,g.text)("category").default("internet")}),oe=U(f);var b=S(require("path"),1),{Pool:le}=R.default;if(!process.env.DATABASE_URL)throw new Error("DATABASE_URL must be set. Did you forget to provision a database?");var ce=new le({connectionString:process.env.DATABASE_URL,ssl:{rejectUnauthorized:!1}}),N=(0,F.drizzle)(ce,{schema:T});(async()=>{try{if(!process.env.DATABASE_URL){console.warn("DATABASE_URL not set, skipping migrations");return}let e=b.default.resolve(process.cwd(),"migrations"),n=await import("fs");n.existsSync(e)&&n.existsSync(b.default.join(e,"meta","_journal.json"))?(console.log("Running migrations..."),await(0,X.migrate)(N,{migrationsFolder:e}),console.log("Migrations completed.")):console.log("No migration files found or journal missing, skipping auto-migration.")}catch(e){console.error("Migration failed:",e)}})();var V=require("drizzle-orm"),_=class{async getPlans(){return await N.select().from(f)}async getPlan(n){return(await N.select().from(f).where((0,V.eq)(f.id,n)))[0]}async seedPlans(){(await N.select().from(f)).length===0&&await N.insert(f).values([{name:"B\xE1sico",speed:"300 MEGA",price:"79,90",features:["Wi-Fi Gr\xE1tis","Instala\xE7\xE3o Gr\xE1tis","Suporte 24h","Fibra \xD3ptica"],category:"internet",isHighlighted:!1},{name:"Essencial",speed:"400 MEGA",price:"89,90",features:["Wi-Fi Gr\xE1tis","Instala\xE7\xE3o Gr\xE1tis","Suporte 24h","Fibra \xD3ptica"],category:"internet",isHighlighted:!1},{name:"Intermedi\xE1rio",speed:"500 MEGA",price:"99,90",features:["Wi-Fi Gr\xE1tis","Instala\xE7\xE3o Gr\xE1tis","Suporte 24h","Fibra \xD3ptica"],category:"internet",isHighlighted:!0},{name:"Avan\xE7ado",speed:"600 MEGA",price:"109,90",features:["Wi-Fi Gr\xE1tis","Instala\xE7\xE3o Gr\xE1tis","Suporte 24h","Fibra \xD3ptica"],category:"internet",isHighlighted:!1},{name:"Ultra",speed:"700 MEGA",price:"119,90",features:["Wi-Fi Gr\xE1tis","Instala\xE7\xE3o Gr\xE1tis","Suporte 24h","Fibra \xD3ptica"],category:"internet",isHighlighted:!1},{name:"Gamer",speed:"800 MEGA",price:"129,90",features:["Wi-Fi Gr\xE1tis","Instala\xE7\xE3o Gr\xE1tis","Suporte 24h","Fibra \xD3ptica"],category:"internet",isHighlighted:!1},{name:"Premium",speed:"900 MEGA",price:"139,90",features:["Wi-Fi Gr\xE1tis","Instala\xE7\xE3o Gr\xE1tis","Suporte 24h","Fibra \xD3ptica"],category:"internet",isHighlighted:!1},{name:"Canais Light",speed:"100+ Canais",price:"17,90",features:["Canais abertos entre outros","Qualidade HD","Suporte para TV, iOS, Android e Web","Lista de canais"],category:"tv",isHighlighted:!1},{name:"Canais Plus",speed:"150+ Canais",price:"39,90",features:["Canais abertos entre outros","Qualidade HD","Suporte para TV, iOS, Android e Web","Lista de canais"],category:"tv",isHighlighted:!1},{name:"Canais Ultra",speed:"200+ Canais",price:"53,90",features:["Canais abertos entre outros","Qualidade HD","Suporte para TV, iOS, Android e Web","Lista de canais"],category:"tv",isHighlighted:!0},{name:"Canais Ultra 1P + HBO",speed:"200+ Canais + HBO",price:"70,90",features:["Canais abertos entre outros","Qualidade HD","Suporte para TV, iOS, Android e Web","Lista de canais"],category:"tv",isHighlighted:!1},{name:"C\xE2mera de Seguran\xE7a",speed:"C\xE2mera",price:"25,00",features:["Acesse de onde estiver","Aplicativo para Android e iOS","Vis\xE3o Noturna","C\xE2mera Full HD"],category:"adicionais",isHighlighted:!1},{name:"Roteador Extra",speed:"WIFI 6",price:"25,00",features:["Maior Alcance","Tecnologia Mesh","F\xE1cil Configura\xE7\xE3o","Gigabit"],category:"adicionais",isHighlighted:!1},{name:"TV Box",speed:"Android TV",price:"25,00",features:["Transforma sua TV","Acesso a Apps","Resolu\xE7\xE3o Full HD","Controle Remoto"],category:"adicionais",isHighlighted:!1}])}},M=new _;var m=require("zod"),pe={validation:m.z.object({message:m.z.string(),field:m.z.string().optional()}),notFound:m.z.object({message:m.z.string()}),internal:m.z.object({message:m.z.string()})},A={plans:{list:{method:"GET",path:"/api/plans",responses:{200:m.z.array(m.z.custom())}},get:{method:"GET",path:"/api/plans/:id",responses:{200:m.z.custom(),404:pe.notFound}}}};async function j(e,n){return n.get(A.plans.list.path,async(t,i)=>{let r=await M.getPlans();i.json(r)}),n.get(A.plans.get.path,async(t,i)=>{let r=await M.getPlan(Number(t.params.id));if(!r)return i.status(404).json({message:"Plan not found"});i.json(r)}),e}var H=S(require("express"),1),q=S(require("fs"),1),E=S(require("path"),1);function B(e){let n=E.default.resolve(__dirname,"public");if(!q.default.existsSync(n))throw new Error(`Could not find the build directory: ${n}, make sure to build the client first`);e.use(H.default.static(n)),e.use("*",(t,i)=>{i.sendFile(E.default.resolve(n,"index.html"))})}var O=require("http"),h=(0,y.default)(),L=(0,O.createServer)(h);h.use(y.default.json({verify:(e,n,t)=>{e.rawBody=t}}));h.use(y.default.urlencoded({extended:!1}));function P(e,n="express"){let t=new Date().toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",second:"2-digit",hour12:!0});console.log(`${t} [${n}] ${e}`)}h.use((e,n,t)=>{let i=Date.now(),r=e.path,s,a=n.json;n.json=function(p,...d){return s=p,a.apply(n,[p,...d])},n.on("finish",()=>{let p=Date.now()-i;if(r.startsWith("/api")){let d=`${e.method} ${r} ${n.statusCode} in ${p}ms`;s&&(d+=` :: ${JSON.stringify(s)}`),P(d)}}),t()});(async()=>{await j(L,h),h.use((n,t,i,r)=>{let s=n.status||n.statusCode||500,a=n.message||"Internal Server Error";i.status(s).json({message:a})}),B(h);let e=parseInt(process.env.PORT||"5000",10);L.listen({port:e,host:"0.0.0.0",reusePort:!0},()=>{P(`serving on port ${e}`)})})();0&&(module.exports={log});
2026-01-09T13:01:53.244451628Z [err]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
2026-01-09T13:01:53.244458173Z [err]  
2026-01-09T13:01:53.244463614Z [err]  Error: DATABASE_URL must be set. Did you forget to provision a database?
2026-01-09T13:01:53.244469423Z [err]      at Object.<anonymous> (/app/dist/index.cjs:1:5913)
2026-01-09T13:01:53.244474346Z [err]      at Module._compile (node:internal/modules/cjs/loader:1521:14)
2026-01-09T13:01:53.244480223Z [err]      at Module._extensions..js (node:internal/modules/cjs/loader:1623:10)
2026-01-09T13:01:53.244487173Z [err]      at Module.load (node:internal/modules/cjs/loader:1266:32)
2026-01-09T13:01:53.244491693Z [err]      at Module._load (node:internal/modules/cjs/loader:1091:12)
2026-01-09T13:01:53.244495968Z [err]      at Function.executeUserEntryPoint [as runMain] (node:internal/modules/run_main:164:12)
2026-01-09T13:01:53.244500419Z [err]      at node:internal/main/run_main_module:28:49
2026-01-09T13:01:53.244505396Z [err]  
2026-01-09T13:01:53.244510565Z [err]  Node.js v20.19.6